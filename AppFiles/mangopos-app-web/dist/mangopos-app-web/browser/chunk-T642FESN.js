import{a as D}from"./chunk-LJW6EPWE.js";import{a as ue,b as fe,c as Ce,e as ge,f as _e,g as xe,h as v}from"./chunk-Z6YHTX75.js";import{a as b,b as S}from"./chunk-26KDQVR5.js";import{b as X,c as Y}from"./chunk-APXOZHQA.js";import{a as te,b as ie,c as oe,d as ae,e as re,f as ne,g as me,h as le,i as se,j as de,k as ce,l as pe}from"./chunk-VJGP4MMT.js";import"./chunk-YCMZOG5D.js";import{a as L,c as z,h as J}from"./chunk-ZWM7H6SC.js";import"./chunk-TEMJ73U5.js";import{b as K,c as Q,i as U,j as W}from"./chunk-EWTXOCXT.js";import{b as B,d as N,f as V,g as q,k as A,n as H,o as O,u as G,w as j,x as P,y as $}from"./chunk-AVLO2MYP.js";import{a as Z,b as ee}from"./chunk-JI7GBIO6.js";import"./chunk-VTP6RNFS.js";import{H as I,I as h,K as T}from"./chunk-M7DMR53X.js";import"./chunk-JAVK727W.js";import"./chunk-3TNWXQYU.js";import"./chunk-UWUK32S4.js";import{l as R,v as M}from"./chunk-ZD4QWOHN.js";import{$ as d,Fb as c,Gb as o,Hb as a,Ib as f,Mb as _,Nb as x,Pb as F,Ub as u,Wa as s,Wb as w,db as k,ea as y,fa as E,ic as n,jb as g,kc as C,pb as p}from"./chunk-WSMHJDAT.js";import"./chunk-C6Q5SG76.js";function be(e,l){e&1&&(o(0,"mat-error"),n(1,"Requerido"),a())}var Me=(()=>{class e{data;form;isEdit=!1;fb=d(j);taxService=d(D);snackBar=d(b);dialogRef=d(ue);constructor(t){this.data=t,this.isEdit=!!t,this.form=this.fb.group({name:[t?.name||"",N.required]})}save(){if(this.form.invalid)return;let{name:t}=this.form.value;(this.isEdit?this.taxService.updateCategory(this.data.id,t):this.taxService.createCategory(t)).subscribe({next:i=>{this.snackBar.open(this.isEdit?"Categor\xEDa actualizada":"Categor\xEDa creada","Cerrar",{duration:3e3}),this.dialogRef.close(!0)},error:i=>{console.error(i);let m="Error al guardar";i.error&&i.error.error&&(m=i.error.error),this.snackBar.open(m,"Cerrar",{duration:5e3})}})}static \u0275fac=function(r){return new(r||e)(k(fe))};static \u0275cmp=g({type:e,selectors:[["app-tax-category-form"]],decls:14,vars:4,consts:[["mat-dialog-title",""],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","name","required",""],[4,"ngIf"],["align","end"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(r,i){if(r&1&&(o(0,"h2",0),n(1),a(),o(2,"form",1),u("ngSubmit",function(){return i.save()}),o(3,"mat-dialog-content")(4,"mat-form-field",2)(5,"mat-label"),n(6,"Nombre"),a(),f(7,"input",3),p(8,be,2,0,"mat-error",4),a()(),o(9,"mat-dialog-actions",5)(10,"button",6),u("click",function(){return i.dialogRef.close()}),n(11,"Cancelar"),a(),o(12,"button",7),n(13,"Guardar"),a()()()),r&2){let m;s(),C("",i.isEdit?"Editar":"Nueva"," Categor\xEDa de Impuesto"),s(),c("formGroup",i.form),s(6),c("ngIf",(m=i.form.get("name"))==null?null:m.hasError("required")),s(4),c("disabled",i.form.invalid)}},dependencies:[M,R,$,A,B,V,q,G,O,H,P,v,ge,xe,_e,W,U,K,Q,Y,X,T,h,S],styles:[".full-width[_ngcontent-%COMP%]{width:100%}"]})}return e})();function Se(e,l){e&1&&(o(0,"th",12),n(1," ID "),a())}function ve(e,l){if(e&1&&(o(0,"td",13),n(1),a()),e&2){let t=l.$implicit;s(),C(" ",t.id," ")}}function De(e,l){e&1&&(o(0,"th",12),n(1," Nombre "),a())}function ye(e,l){if(e&1&&(o(0,"td",13),n(1),a()),e&2){let t=l.$implicit;s(),C(" ",t.name," ")}}function Ee(e,l){e&1&&f(0,"th",12)}function we(e,l){if(e&1){let t=F();o(0,"td",13)(1,"button",14),u("click",function(){let i=y(t).$implicit,m=w();return E(m.openForm(i))}),o(2,"mat-icon"),n(3,"edit"),a()(),o(4,"button",15),u("click",function(){let i=y(t).$implicit,m=w();return E(m.deleteCategory(i))}),o(5,"mat-icon"),n(6,"delete"),a()()()}}function ke(e,l){e&1&&f(0,"tr",16)}function Fe(e,l){e&1&&f(0,"tr",17)}function Re(e,l){e&1&&(o(0,"tr",18)(1,"td",19),n(2,"No hay categor\xEDas registradas"),a()())}var st=(()=>{class e{categories=[];displayedColumns=["name","actions"];taxService=d(D);dialog=d(Ce);snackBar=d(b);ngOnInit(){this.loadCategories()}loadCategories(){this.taxService.getAllCategories().subscribe({next:t=>{this.categories=t},error:t=>{console.error(t),this.snackBar.open("Error al cargar categor\xEDas","Cerrar",{duration:3e3})}})}openForm(t){this.dialog.open(Me,{width:"400px",data:t||null}).afterClosed().subscribe(i=>{i&&this.loadCategories()})}deleteCategory(t){confirm(`\xBFEst\xE1s seguro de eliminar la categor\xEDa "${t.name}"?`)&&this.taxService.deleteCategory(t.id).subscribe({next:()=>{this.snackBar.open("Categor\xEDa eliminada","Cerrar",{duration:3e3}),this.loadCategories()},error:r=>{console.error(r);let i="Error al eliminar";r.error&&r.error.error&&(i=r.error.error),this.snackBar.open(i,"Cerrar",{duration:5e3})}})}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=g({type:e,selectors:[["app-tax-categories"]],decls:23,vars:3,consts:[[1,"container"],[1,"header"],["mat-raised-button","","color","primary",3,"click"],["mat-table","",1,"full-width",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","6",1,"mat-cell"]],template:function(r,i){r&1&&(o(0,"div",0)(1,"div",1)(2,"h2"),n(3,"Categor\xEDas de Impuestos"),a(),o(4,"button",2),u("click",function(){return i.openForm()}),o(5,"mat-icon"),n(6,"add"),a(),n(7," Nueva Categor\xEDa "),a()(),o(8,"mat-card")(9,"mat-card-content")(10,"table",3),_(11,4),p(12,Se,2,0,"th",5)(13,ve,2,1,"td",6),x(),_(14,7),p(15,De,2,0,"th",5)(16,ye,2,1,"td",6),x(),_(17,8),p(18,Ee,1,0,"th",5)(19,we,7,0,"td",6),x(),p(20,ke,1,0,"tr",9)(21,Fe,1,0,"tr",10)(22,Re,3,0,"tr",11),a()()()()),r&2&&(s(10),c("dataSource",i.categories),s(10),c("matHeaderRowDef",i.displayedColumns),s(),c("matRowDefColumns",i.displayedColumns))},dependencies:[M,pe,te,oe,me,ae,ie,le,re,ne,se,de,ce,T,h,I,ee,Z,J,L,z,v,S],styles:[".container[_ngcontent-%COMP%]{padding:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.full-width[_ngcontent-%COMP%]{width:100%}td.mat-cell[_ngcontent-%COMP%]{padding:8px}"]})}return e})();export{st as TaxCategoriesComponent};
