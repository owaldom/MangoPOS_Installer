import{a as s}from"./chunk-YCMZOG5D.js";import{d as l}from"./chunk-3TNWXQYU.js";import{W as c,_ as o,f as n,n as i}from"./chunk-WSMHJDAT.js";var m=(()=>{class a{http;apiUrl=`${s.apiUrl}/settings`;settingsSubject=new n(null);settings$=this.settingsSubject.asObservable();constructor(t){this.http=t,this.loadSettings()}async loadSettings(){try{let t=await i(this.http.get(this.apiUrl)),e={price_decimals:parseInt(t.price_decimals)||2,total_decimals:parseInt(t.total_decimals)||2,quantity_decimals:parseInt(t.quantity_decimals)||3,currency_symbol:t.currency_symbol||"Bs.",currency_code:t.currency_code||"VES",company_name:t.company_name||"MANGOPOS",company_address:t.company_address||"",enable_pdf_ticket:t.enable_pdf_ticket==="true",percentage_decimals:parseInt(t.percentage_decimals)||0,pos_layout:t.pos_layout||"classic",print_server_url:t.print_server_url||"http://localhost:3001/api",igtf_enabled:t.igtf_enabled==="true",igtf_percentage:parseFloat(t.igtf_percentage)||3};return this.settingsSubject.next(e),e}catch(t){throw console.error("Error loading settings",t),t}}getSettings(){return this.settingsSubject.value}async updateSettings(t){await i(this.http.put(this.apiUrl,t)),this.settingsSubject.next(t)}getCurrencies(){return this.http.get(`${s.apiUrl}/sales/currencies`)}async updateCurrency(t,e){await i(this.http.put(`${this.apiUrl}/currency/${t}`,e))}getDecimalFormat(t){let e=this.getSettings();if(!e)return"1.2-2";let r=2;return t==="price"&&(r=e.price_decimals),t==="total"&&(r=e.total_decimals),t==="quantity"&&(r=e.quantity_decimals),t==="percent"&&(r=e.percentage_decimals),`1.${r}-${r}`}exchangeRate=1;async loadExchangeRate(){try{let e=(await i(this.getCurrencies())).find(r=>r.symbol==="$"||r.code==="USD");return e&&(this.exchangeRate=parseFloat(e.exchange_rate)),this.exchangeRate}catch(t){return console.error("Error loading exchange rate",t),1}}getExchangeRate(){return this.exchangeRate}static \u0275fac=function(e){return new(e||a)(o(l))};static \u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();export{m as a};
