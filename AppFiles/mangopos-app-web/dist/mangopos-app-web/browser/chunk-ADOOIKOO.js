import{a as B}from"./chunk-6KZJ4RFY.js";import{c as L}from"./chunk-6OXQWIOV.js";import"./chunk-YCMZOG5D.js";import{b as T,f as N,j as V,p as z,q as A,r as W,x as j}from"./chunk-AVLO2MYP.js";import"./chunk-3TNWXQYU.js";import{k,l as D,r as F,v as I}from"./chunk-ZD4QWOHN.js";import{Fb as l,Gb as e,Hb as n,Pb as f,Ub as p,Wa as d,Wb as s,db as C,ea as m,fa as _,hc as S,ic as i,jb as M,jc as x,kc as O,lc as y,nc as v,oc as h,pb as b,pc as P,vc as E,xc as w}from"./chunk-WSMHJDAT.js";import"./chunk-C6Q5SG76.js";function R(o,g){o&1&&(e(0,"div",17),i(1," Cargando... "),n())}function J(o,g){if(o&1&&(e(0,"div",18),i(1),n()),o&2){let t=s();d(),O(" ",t.error," ")}}function H(o,g){if(o&1){let t=f();e(0,"button",26),p("click",function(){m(t);let r=s().$implicit,c=s(2);return _(c.exportOrder(r))}),e(1,"i",3),i(2,"download"),n()()}}function $(o,g){if(o&1){let t=f();e(0,"tr")(1,"td"),i(2),n(),e(3,"td"),i(4),n(),e(5,"td"),i(6),E(7,"date"),n(),e(8,"td")(9,"span"),i(10),n()(),e(11,"td",23)(12,"button",24),p("click",function(){let r=m(t).$implicit,c=s(2);return _(c.viewOrder(r))}),e(13,"i",3),i(14,"visibility"),n()(),b(15,H,3,0,"button",25),n()()}if(o&2){let t=g.$implicit,a=s(2);d(2),x(t.order_number),d(2),x(t.destination_location_name),d(2),x(w(7,7,t.date_created,"dd/MM/yyyy HH:mm")),d(3),S("status-badge "+a.getStatusClass(t.status)),d(),O(" ",a.getStatusLabel(t.status)," "),d(5),l("ngIf",t.status==="pending"||t.status==="exported")}}function q(o,g){o&1&&(e(0,"tr")(1,"td",27),i(2," No hay \xF3rdenes de distribuci\xF3n "),n()())}function G(o,g){if(o&1&&(e(0,"div",19)(1,"table",20)(2,"thead")(3,"tr")(4,"th"),i(5,"N\xFAmero de Orden"),n(),e(6,"th"),i(7,"Destino"),n(),e(8,"th"),i(9,"Fecha Creaci\xF3n"),n(),e(10,"th"),i(11,"Estado"),n(),e(12,"th"),i(13,"Acciones"),n()()(),e(14,"tbody"),b(15,$,16,10,"tr",21)(16,q,3,0,"tr",22),n()()()),o&2){let t=s();d(15),l("ngForOf",t.orders),d(),l("ngIf",t.orders.length===0)}}function K(o,g){if(o&1){let t=f();e(0,"div",28)(1,"button",29),p("click",function(){m(t);let r=s();return _(r.onPageChange(r.currentPage-1))}),i(2," Anterior "),n(),e(3,"span"),i(4),n(),e(5,"button",29),p("click",function(){m(t);let r=s();return _(r.onPageChange(r.currentPage+1))}),i(6," Siguiente "),n()()}if(o&2){let t=s();d(),l("disabled",t.currentPage===1),d(3),y("P\xE1gina ",t.currentPage," de ",t.totalPages),d(),l("disabled",t.currentPage===t.totalPages)}}var rt=(()=>{class o{distributionService;router;orders=[];loading=!1;error=null;currentPage=1;pageSize=50;totalItems=0;totalPages=0;statusFilter="";searchFilter="";displayedColumns=["order_number","destination","date_created","status","actions"];constructor(t,a){this.distributionService=t,this.router=a}ngOnInit(){this.loadOrders()}loadOrders(){this.loading=!0,this.error=null,this.distributionService.getAllOrders(this.currentPage,this.pageSize,this.statusFilter,this.searchFilter).subscribe({next:t=>{this.orders=t.data,this.totalItems=t.total,this.totalPages=t.totalPages,this.loading=!1},error:t=>{this.error="Error al cargar las \xF3rdenes de distribuci\xF3n",console.error(t),this.loading=!1}})}onPageChange(t){this.currentPage=t,this.loadOrders()}onFilterChange(){this.currentPage=1,this.loadOrders()}createNewOrder(){this.router.navigate(["/dashboard/inventario/distribution-orders/new"])}viewOrder(t){this.router.navigate(["/dashboard/inventario/distribution-orders",t.id])}exportOrder(t){t.id&&this.distributionService.exportOrder(t.id).subscribe({next:a=>{let r=`${t.order_number}.json`;this.distributionService.downloadJSON(a,r),alert(`Archivo ${r} descargado exitosamente`),this.loadOrders()},error:a=>{alert("Error al exportar la orden"),console.error(a)}})}getStatusLabel(t){return{pending:"Pendiente",exported:"Exportada",received:"Recibida",cancelled:"Cancelada"}[t]||t}getStatusClass(t){return{pending:"status-pending",exported:"status-exported",received:"status-received",cancelled:"status-cancelled"}[t]||""}static \u0275fac=function(a){return new(a||o)(C(B),C(L))};static \u0275cmp=M({type:o,selectors:[["app-distribution-orders-list"]],decls:31,vars:6,consts:[[1,"distribution-orders-container"],[1,"header"],[1,"btn","btn-primary",3,"click"],[1,"material-icons"],[1,"filters"],[1,"filter-group"],["type","text","placeholder","N\xFAmero de orden o destino",3,"ngModelChange","input","ngModel"],[3,"ngModelChange","change","ngModel"],["value",""],["value","pending"],["value","exported"],["value","received"],["value","cancelled"],["class","loading",4,"ngIf"],["class","error",4,"ngIf"],["class","table-container",4,"ngIf"],["class","pagination",4,"ngIf"],[1,"loading"],[1,"error"],[1,"table-container"],[1,"data-table"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"actions"],["title","Ver detalles",1,"btn-icon",3,"click"],["class","btn-icon","title","Exportar a JSON",3,"click",4,"ngIf"],["title","Exportar a JSON",1,"btn-icon",3,"click"],["colspan","5",1,"no-data"],[1,"pagination"],[3,"click","disabled"]],template:function(a,r){a&1&&(e(0,"div",0)(1,"div",1)(2,"h2"),i(3,"\xD3rdenes de Distribuci\xF3n"),n(),e(4,"button",2),p("click",function(){return r.createNewOrder()}),e(5,"i",3),i(6,"add"),n(),i(7," Nueva Distribuci\xF3n "),n()(),e(8,"div",4)(9,"div",5)(10,"label"),i(11,"Buscar:"),n(),e(12,"input",6),P("ngModelChange",function(u){return h(r.searchFilter,u)||(r.searchFilter=u),u}),p("input",function(){return r.onFilterChange()}),n()(),e(13,"div",5)(14,"label"),i(15,"Estado:"),n(),e(16,"select",7),P("ngModelChange",function(u){return h(r.statusFilter,u)||(r.statusFilter=u),u}),p("change",function(){return r.onFilterChange()}),e(17,"option",8),i(18,"Todos"),n(),e(19,"option",9),i(20,"Pendiente"),n(),e(21,"option",10),i(22,"Exportada"),n(),e(23,"option",11),i(24,"Recibida"),n(),e(25,"option",12),i(26,"Cancelada"),n()()()(),b(27,R,2,0,"div",13)(28,J,2,1,"div",14)(29,G,17,2,"div",15)(30,K,7,4,"div",16),n()),a&2&&(d(12),v("ngModel",r.searchFilter),d(4),v("ngModel",r.statusFilter),d(11),l("ngIf",r.loading),d(),l("ngIf",r.error),d(),l("ngIf",!r.loading&&!r.error),d(),l("ngIf",r.totalPages>1))},dependencies:[I,k,D,j,A,W,T,z,N,V,F],styles:[".distribution-orders-container[_ngcontent-%COMP%]{padding:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:24px;color:#333}.btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:4px;cursor:pointer;font-size:14px;display:inline-flex;align-items:center;gap:8px}.btn-primary[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#45a049}.filters[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:20px;padding:15px;background-color:#f5f5f5;border-radius:4px}.filter-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#666}.filter-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:8px;border:1px solid #ddd;border-radius:4px;font-size:14px}.loading[_ngcontent-%COMP%], .error[_ngcontent-%COMP%]{padding:20px;text-align:center;font-size:16px}.error[_ngcontent-%COMP%]{color:#d32f2f;background-color:#ffebee;border-radius:4px}.table-container[_ngcontent-%COMP%]{overflow-x:auto;background-color:#fff;border-radius:4px;box-shadow:0 2px 4px #0000001a}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#f5f5f5}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:12px;text-align:left;font-weight:600;color:#333;border-bottom:2px solid #ddd}.data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;border-bottom:1px solid #eee}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}.no-data[_ngcontent-%COMP%]{text-align:center;color:#999;font-style:italic}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:12px;font-size:12px;font-weight:600;text-transform:uppercase}.status-pending[_ngcontent-%COMP%]{background-color:#fff3cd;color:#856404}.status-exported[_ngcontent-%COMP%]{background-color:#cce5ff;color:#004085}.status-received[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724}.status-cancelled[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24}.actions[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-icon[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;padding:4px;border-radius:4px;color:#666}.btn-icon[_ngcontent-%COMP%]:hover{background-color:#f0f0f0;color:#333}.btn-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:20px;margin-top:20px;padding:15px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 16px;border:1px solid #ddd;background-color:#fff;border-radius:4px;cursor:pointer}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#f5f5f5}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;color:#666}"]})}return o})();export{rt as DistributionOrdersListComponent};
