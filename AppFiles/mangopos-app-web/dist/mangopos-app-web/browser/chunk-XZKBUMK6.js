import{a as A}from"./chunk-6KZJ4RFY.js";import{c as N}from"./chunk-6OXQWIOV.js";import"./chunk-YCMZOG5D.js";import{b as F,f as k,j as T,p as V,q as B,r as W,u as z,x as q}from"./chunk-AVLO2MYP.js";import"./chunk-3TNWXQYU.js";import{k as E,l as D,r as I,u as w,v as R}from"./chunk-ZD4QWOHN.js";import{Fb as p,Gb as i,Hb as t,Pb as h,Ub as v,Wa as r,Wb as d,db as y,ea as u,fa as g,ic as n,jb as S,jc as s,kc as x,nc as _,oc as b,pb as f,pc as C,vc as M,xc as P,zc as O}from"./chunk-WSMHJDAT.js";import"./chunk-C6Q5SG76.js";function L(a,m){if(a&1&&(i(0,"div",14),n(1),t()),a&2){let e=d();r(),x(" ",e.error," ")}}function J(a,m){if(a&1&&(i(0,"div",15),n(1),t()),a&2){let e=d();r(),x(" ",e.fileError," ")}}function U(a,m){if(a&1&&(i(0,"div",16)(1,"i",9),n(2,"check_circle"),t(),n(3),t()),a&2){let e=d();r(3),x(" Archivo cargado: ",e.importedData.distribution_order.order_number," ")}}function G(a,m){if(a&1&&(i(0,"tr")(1,"td"),n(2),t(),i(3,"td"),n(4),t(),i(5,"td"),n(6),t(),i(7,"td"),n(8),M(9,"currency"),t(),i(10,"td"),n(11),M(12,"currency"),t()()),a&2){let e=m.$implicit;r(2),s(e.product_code),r(2),s(e.product_name),r(2),s(e.quantity),r(2),s(O(9,5,e.unit_cost,"USD","symbol","1.2-2")),r(3),s(O(12,10,e.quantity*e.unit_cost,"USD","symbol","1.2-2"))}}function H(a,m){if(a&1&&(i(0,"div",22)(1,"label"),n(2,"Notas:"),t(),i(3,"p"),n(4),t()()),a&2){let e=d(2);r(4),s(e.importedData.distribution_order.notes)}}function K(a,m){if(a&1&&(i(0,"div",5)(1,"h3"),n(2,"2. Detalles de la Distribuci\xF3n"),t(),i(3,"div",17)(4,"div",18)(5,"label"),n(6,"N\xFAmero de Orden:"),t(),i(7,"span"),n(8),t()(),i(9,"div",18)(10,"label"),n(11,"Origen:"),t(),i(12,"span"),n(13),t()(),i(14,"div",18)(15,"label"),n(16,"Destino:"),t(),i(17,"span"),n(18),t()(),i(19,"div",18)(20,"label"),n(21,"Fecha Creaci\xF3n:"),t(),i(22,"span"),n(23),M(24,"date"),t()(),i(25,"div",18)(26,"label"),n(27,"Total Items:"),t(),i(28,"span"),n(29),t()()(),i(30,"div",19)(31,"h4"),n(32,"Productos"),t(),i(33,"table")(34,"thead")(35,"tr")(36,"th"),n(37,"C\xF3digo"),t(),i(38,"th"),n(39,"Producto"),t(),i(40,"th"),n(41,"Cantidad"),t(),i(42,"th"),n(43,"Costo Unit."),t(),i(44,"th"),n(45,"Subtotal"),t()()(),i(46,"tbody"),f(47,G,13,15,"tr",20),t()()(),f(48,H,5,1,"div",21),t()),a&2){let e=d();r(8),s(e.importedData.distribution_order.order_number),r(5),s(e.importedData.distribution_order.origin),r(5),s(e.importedData.distribution_order.destination),r(5),s(P(24,7,e.importedData.distribution_order.date_created,"dd/MM/yyyy HH:mm")),r(6),s(e.getTotalItems()),r(18),p("ngForOf",e.importedData.distribution_order.lines),r(),p("ngIf",e.importedData.distribution_order.notes)}}function Q(a,m){if(a&1&&(i(0,"option",31),n(1),t()),a&2){let e=m.$implicit;p("value",e.id),r(),x(" ",e.name," ")}}function X(a,m){if(a&1){let e=h();i(0,"div",5)(1,"h3"),n(2,"3. Informaci\xF3n de Recepci\xF3n"),t(),i(3,"div",23)(4,"div",24)(5,"label"),n(6,"N\xFAmero de Gu\xEDa de Despacho"),t(),i(7,"input",25),C("ngModelChange",function(o){u(e);let c=d();return b(c.dispatchDocumentNumber,o)||(c.dispatchDocumentNumber=o),g(o)}),t(),i(8,"small"),n(9,"Ingrese el n\xFAmero del documento f\xEDsico recibido"),t()(),i(10,"div",24)(11,"label"),n(12,"Almac\xE9n Destino *"),t(),i(13,"select",26),C("ngModelChange",function(o){u(e);let c=d();return b(c.locationId,o)||(c.locationId=o),g(o)}),i(14,"option",27),n(15,"Seleccione almac\xE9n"),t(),f(16,Q,2,2,"option",28),t()()(),i(17,"div",23)(18,"div",24)(19,"label"),n(20,"Recibido Por *"),t(),i(21,"input",29),C("ngModelChange",function(o){u(e);let c=d();return b(c.receivedBy,o)||(c.receivedBy=o),g(o)}),t()()(),i(22,"div",24)(23,"label"),n(24,"Observaciones de Recepci\xF3n"),t(),i(25,"textarea",30),C("ngModelChange",function(o){u(e);let c=d();return b(c.receptionNotes,o)||(c.receptionNotes=o),g(o)}),t()()()}if(a&2){let e=d();r(7),_("ngModel",e.dispatchDocumentNumber),r(6),_("ngModel",e.locationId),r(3),p("ngForOf",e.locations),r(5),_("ngModel",e.receivedBy),r(4),_("ngModel",e.receptionNotes)}}function Y(a,m){if(a&1){let e=h();i(0,"div",32)(1,"button",33),v("click",function(){u(e);let o=d();return g(o.reset())}),n(2," Limpiar "),t(),i(3,"button",34),v("click",function(){u(e);let o=d();return g(o.submit())}),i(4,"i",9),n(5,"check"),t(),n(6),t()()}if(a&2){let e=d();r(),p("disabled",e.loading),r(2),p("disabled",!e.canSubmit()||e.loading),r(3),x(" ",e.loading?"Procesando...":"Confirmar Recepci\xF3n"," ")}}var de=(()=>{class a{distributionService;router;importedData=null;dispatchDocumentNumber="";locationId=0;receivedBy="";receptionNotes="";locations=[];loading=!1;error=null;fileError=null;constructor(e,l){this.distributionService=e,this.router=l}ngOnInit(){this.loadLocations()}loadLocations(){}onFileSelected(e){let l=e.target.files[0];if(l){if(!l.name.endsWith(".json")){this.fileError="El archivo debe ser un JSON";return}this.fileError=null,this.loading=!0,this.distributionService.readJSONFile(l).then(o=>{this.importedData=o,this.loading=!1,o.distribution_order.dispatch_document_number&&(this.dispatchDocumentNumber=o.distribution_order.dispatch_document_number)},o=>{this.fileError=o.message||"Error al leer el archivo",this.loading=!1})}}getTotalItems(){return this.importedData?this.importedData.distribution_order.lines.reduce((e,l)=>e+l.quantity,0):0}canSubmit(){return!!(this.importedData&&this.locationId&&this.receivedBy)}submit(){if(!this.canSubmit()||!this.importedData){alert("Complete todos los campos requeridos");return}let e={distribution_data:this.importedData,dispatch_document_number:this.dispatchDocumentNumber,location_id:this.locationId,received_by:this.receivedBy,reception_notes:this.receptionNotes};this.loading=!0,this.error=null,this.distributionService.importOrder(e).subscribe({next:l=>{alert(`Distribuci\xF3n recibida exitosamente: ${l.order_number}`),this.reset()},error:l=>{this.error=l.error?.error||"Error al recibir la distribuci\xF3n",alert(this.error),this.loading=!1}})}reset(){this.importedData=null,this.dispatchDocumentNumber="",this.locationId=0,this.receivedBy="",this.receptionNotes="",this.error=null,this.fileError=null}cancel(){this.router.navigate(["/dashboard/inventario/distribution-reception"])}static \u0275fac=function(l){return new(l||a)(y(A),y(N))};static \u0275cmp=S({type:a,selectors:[["app-distribution-reception"]],decls:21,vars:6,consts:[["fileInput",""],[1,"reception-container"],[1,"header"],["class","error",4,"ngIf"],[1,"reception-form"],[1,"form-section"],[1,"file-upload"],["type","file","accept",".json","id","fileInput",3,"change"],["for","fileInput",1,"file-label"],[1,"material-icons"],["class","file-error",4,"ngIf"],["class","file-info",4,"ngIf"],["class","form-section",4,"ngIf"],["class","form-actions",4,"ngIf"],[1,"error"],[1,"file-error"],[1,"file-info"],[1,"info-grid"],[1,"info-item"],[1,"products-table"],[4,"ngFor","ngForOf"],["class","notes",4,"ngIf"],[1,"notes"],[1,"form-row"],[1,"form-group"],["type","text","placeholder","Ej: GD-2026-001",3,"ngModelChange","ngModel"],["required","",3,"ngModelChange","ngModel"],["value","0"],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","Nombre de quien recibe","required","",3,"ngModelChange","ngModel"],["rows","3","placeholder","Ej: 1 unidad rota en transporte, diferencias encontradas, etc.",3,"ngModelChange","ngModel"],[3,"value"],[1,"form-actions"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","button",1,"btn","btn-primary",3,"click","disabled"]],template:function(l,o){if(l&1){let c=h();i(0,"div",1)(1,"div",2)(2,"h2"),n(3,"Recibir Mercanc\xEDa - Distribuci\xF3n"),t()(),f(4,L,2,1,"div",3),i(5,"div",4)(6,"div",5)(7,"h3"),n(8,"1. Importar Archivo de Distribuci\xF3n"),t(),i(9,"div",6)(10,"input",7,0),v("change",function(j){return u(c),g(o.onFileSelected(j))}),t(),i(12,"label",8)(13,"i",9),n(14,"cloud_upload"),t(),n(15," Seleccionar archivo JSON "),t(),f(16,J,2,1,"div",10),t(),f(17,U,4,1,"div",11),t(),f(18,K,49,10,"div",12)(19,X,26,5,"div",12)(20,Y,7,3,"div",13),t()()}l&2&&(r(4),p("ngIf",o.error),r(12),p("ngIf",o.fileError),r(),p("ngIf",o.importedData),r(),p("ngIf",o.importedData),r(),p("ngIf",o.importedData),r(),p("ngIf",o.importedData))},dependencies:[R,E,D,q,B,W,F,V,k,z,T,w,I],styles:[".reception-container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 20px;font-size:24px;color:#333}.error[_ngcontent-%COMP%]{padding:12px;margin-bottom:20px;background-color:#ffebee;color:#d32f2f;border-radius:4px;border-left:4px solid #d32f2f}.reception-form[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a;padding:24px}.form-section[_ngcontent-%COMP%]{margin-bottom:30px;padding-bottom:30px;border-bottom:1px solid #eee}.form-section[_ngcontent-%COMP%]:last-of-type{border-bottom:none}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;font-size:18px;color:#333;display:flex;align-items:center;gap:8px}.form-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:16px 0 12px;font-size:16px;color:#555}.file-upload[_ngcontent-%COMP%]{position:relative}.file-upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{display:none}.file-label[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:12px 24px;background-color:#2196f3;color:#fff;border-radius:4px;cursor:pointer;transition:background-color .2s}.file-label[_ngcontent-%COMP%]:hover{background-color:#1976d2}.file-error[_ngcontent-%COMP%]{margin-top:8px;color:#d32f2f;font-size:14px}.file-info[_ngcontent-%COMP%]{margin-top:16px;padding:12px;background-color:#e8f5e9;color:#2e7d32;border-radius:4px;display:flex;align-items:center;gap:8px}.info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin-bottom:20px}.info-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.info-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#666;text-transform:uppercase}.info-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px;color:#333}.products-table[_ngcontent-%COMP%]{margin-top:16px;overflow-x:auto}.products-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.products-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#f5f5f5}.products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:12px;text-align:left;font-weight:600;color:#333;border-bottom:2px solid #ddd}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;border-bottom:1px solid #eee}.notes[_ngcontent-%COMP%]{margin-top:16px;padding:12px;background-color:#fff9c4;border-radius:4px;border-left:4px solid #fbc02d}.notes[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#666;display:block;margin-bottom:8px}.notes[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#333}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin-bottom:16px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#555}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:10px;border:1px solid #ddd;border-radius:4px;font-size:14px;font-family:inherit}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3;box-shadow:0 0 0 2px #2196f31a}.form-group[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px;color:#999}.btn[_ngcontent-%COMP%]{padding:12px 24px;border:none;border-radius:4px;cursor:pointer;font-size:14px;font-weight:600;display:inline-flex;align-items:center;gap:8px;transition:all .2s}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#45a049}.btn-secondary[_ngcontent-%COMP%]{background-color:#757575;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#616161}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:24px;padding-top:24px;border-top:1px solid #eee}"]})}return a})();export{de as DistributionReceptionComponent};
