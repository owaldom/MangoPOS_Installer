import{a as f}from"./chunk-DGQM6DPS.js";import{a as p}from"./chunk-AVLO2MYP.js";import{$ as l,Ub as g,V as a,db as h,lb as m,rc as d,va as o,ya as c}from"./chunk-WSMHJDAT.js";var I=(()=>{class s{el;decimalType="total";settingsService=l(f);_value=null;onChange=()=>{};onTouched=()=>{};settingsSubscription;constructor(e){this.el=e,this.settingsSubscription=this.settingsService.settings$.subscribe(()=>{this._value!==null&&this.formatValue(this._value)})}ngOnChanges(e){this._value!==null&&this.formatValue(this._value)}ngOnDestroy(){this.settingsSubscription&&this.settingsSubscription.unsubscribe()}getDecimals(){let e=this.settingsService.getSettings();return e?this.decimalType==="price"?e.price_decimals:this.decimalType==="quantity"?e.quantity_decimals:this.decimalType==="percent"?e.percentage_decimals:e.total_decimals:2}onInput(e){let i=e.target.value.replace(/[^0-9]/g,"");if(!i){this._value=null,this.onChange(null);return}i=BigInt(i).toString();let r=this.getDecimals(),v=Math.pow(10,r),u=parseFloat(i)/v;this._value=u,this.formatValue(u),this.onChange(u)}onBlur(){this.onTouched()}writeValue(e){let t=e==null?null:Number(e);this._value=t,this.formatValue(t)}formatValue(e){let t=this.el.nativeElement;if(e==null||isNaN(e)){t.value="";return}let n=this.getDecimals();try{let i=e.toLocaleString("es-VE",{minimumFractionDigits:n,maximumFractionDigits:n});t.value=i}catch{t.value=e.toFixed(n)}}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.el.nativeElement.disabled=e}static \u0275fac=function(t){return new(t||s)(h(c))};static \u0275dir=m({type:s,selectors:[["","appMoneyInput",""]],hostBindings:function(t,n){t&1&&g("input",function(r){return n.onInput(r)})("blur",function(){return n.onBlur()})},inputs:{decimalType:"decimalType"},features:[d([{provide:p,useExisting:a(()=>s),multi:!0}]),o]})}return s})();export{I as a};
