import{b as Kt,c as Qt,d as Xt}from"./chunk-ISB5W5SX.js";import{a as lt}from"./chunk-R3L57XND.js";import{b as Zt}from"./chunk-NL74O3Y5.js";import{a as Jt}from"./chunk-34EVCEMG.js";import{a as Wt,b as qt}from"./chunk-XEWEKXFC.js";import{a as Ut}from"./chunk-RFRKPPY3.js";import{a as et,b as it,e as nt,f as ot,g as at,h as rt}from"./chunk-Z6YHTX75.js";import{a as tt}from"./chunk-DGQM6DPS.js";import{a as Lt,b as zt,c as Gt,d as jt}from"./chunk-N7P7XLP2.js";import{a as Ft}from"./chunk-N5ZCCEPE.js";import{d as Ct,e as _t}from"./chunk-GRESZPIF.js";import{b as J,c as Z}from"./chunk-APXOZHQA.js";import{a as Pt,b as Tt,c as Ht,d as kt,e as Rt,f as $t,g as Ot,h as At,i as Nt,j as Vt,l as Bt}from"./chunk-VJGP4MMT.js";import{a as X,b as Y}from"./chunk-VNZMNOUU.js";import{d as N}from"./chunk-52A733DE.js";import{b as j,c as Et,e as It,f as W,i as q,j as U}from"./chunk-EWTXOCXT.js";import{b as L,d as st,f as z,g as xt,j as vt,k as yt,n as bt,o as Mt,u as Dt,w as wt,x as G,y as St}from"./chunk-AVLO2MYP.js";import{a as K,b as Q}from"./chunk-JI7GBIO6.js";import{H as ht,I as V,K as B}from"./chunk-M7DMR53X.js";import{k as $,l as O,r as y,s as b,v as A}from"./chunk-ZD4QWOHN.js";import{$ as h,Ac as gt,Fb as d,Gb as n,Hb as i,Ib as p,Mb as M,Nb as D,Pb as I,Ub as _,Wa as r,Wb as f,cb as pt,db as E,ea as u,ec as mt,fa as g,fb as ft,ic as o,jb as P,jc as F,kc as C,lb as ut,nc as T,oc as H,pb as c,pc as k,rc as R,va as dt,vc as w,xc as S,ya as ct}from"./chunk-WSMHJDAT.js";var te=(()=>{class e{el;renderer;viewContainerRef;isLoading=!1;color;spinnerRef=null;originalContent;originalWidth="";constructor(t,l,a){this.el=t,this.renderer=l,this.viewContainerRef=a}ngOnChanges(t){t.isLoading&&(this.isLoading?this.showSpinner():this.hideSpinner())}showSpinner(){let t=this.el.nativeElement;this.originalWidth=t.style.width;let l=t.getBoundingClientRect();l.width>0&&this.renderer.setStyle(t,"width",`${l.width}px`),this.renderer.setAttribute(t,"disabled","true"),this.renderer.addClass(t,"mat-button-disabled"),this.spinnerRef=this.viewContainerRef.createComponent(Ft),this.spinnerRef.instance.mode="indeterminate",this.spinnerRef.instance.diameter=20,this.spinnerRef.instance.color=void 0,this.renderer.appendChild(t,this.spinnerRef.location.nativeElement),this.renderer.setStyle(this.spinnerRef.location.nativeElement,"display","inline-block"),this.renderer.setStyle(this.spinnerRef.location.nativeElement,"vertical-align","middle"),this.renderer.setStyle(this.spinnerRef.location.nativeElement,"margin-left","8px")}hideSpinner(){let t=this.el.nativeElement;this.spinnerRef&&(this.spinnerRef.destroy(),this.spinnerRef=null),this.renderer.removeAttribute(t,"disabled"),this.renderer.removeClass(t,"mat-button-disabled"),this.renderer.setStyle(t,"width",this.originalWidth)}static \u0275fac=function(l){return new(l||e)(E(ct),E(pt),E(ft))};static \u0275dir=ut({type:e,selectors:[["","appLoading",""]],inputs:{isLoading:[0,"appLoading","isLoading"],color:"color"},features:[dt]})}return e})();function se(e,m){e&1&&(n(0,"mat-error"),o(1," El nombre es obligatorio "),i())}function de(e,m){if(e&1&&(n(0,"div",5)(1,"mat-form-field",31)(2,"mat-label"),o(3,"Deuda Actual $"),i(),p(4,"input",32),w(5,"number"),n(6,"mat-icon",33),o(7,"account_balance_wallet"),i()(),n(8,"mat-form-field",31)(9,"mat-label"),o(10,"\xDAltima Operaci\xF3n"),i(),p(11,"input",32),w(12,"date"),n(13,"mat-icon",33),o(14,"event"),i()()()),e&2){let t=f();r(4),d("value",S(5,2,t.data.customer.curdebt,t.settingsService.getDecimalFormat("total"))),r(7),d("value",S(12,5,t.data.customer.curdate,"dd/MM/yyyy HH:mm"))}}function ce(e,m){if(e&1&&(n(0,"mat-option",19),o(1),i()),e&2){let t=m.$implicit;d("value",t.id),r(),C(" ",t.name," ")}}function pe(e,m){if(e&1){let t=I();n(0,"button",34),_("click",function(){u(t);let a=f();return g(a.onSave())}),o(1),i()}if(e&2){let t=f();d("disabled",!t.customerForm.valid||t.saving)("appLoading",t.saving),r(),C(" ",t.saving?"GUARDANDO...":t.data!=null&&t.data.customer?"ACTUALIZAR":"GUARDAR"," ")}}var mi=(()=>{class e{fb=h(wt);dialogRef=h(et);data=h(it,{optional:!0});customerService=h(lt);discountService=h(Jt);settingsService=h(tt);customerForm;saving=!1;discountCategories=[];ngOnInit(){this.initForm(),this.loadDiscountCategories(),this.data?.customer&&this.customerForm.patchValue(this.data.customer),this.data?.viewOnly&&this.customerForm.disable()}getTitle(){return this.data?.viewOnly?"Datos del Cliente":this.data?.customer?"Editar Cliente":"Nuevo Cliente"}initForm(){this.customerForm=this.fb.group({name:["",st.required],taxid:[""],searchkey:[""],firstname:[""],lastname:[""],email:["",st.email],phone:[""],address:[""],notes:[""],visible:[!0],maxdebt:[0],discountcategory:[null]})}loadDiscountCategories(){this.discountService.getDiscountCustCategories().subscribe(t=>{this.discountCategories=t})}onSave(){if(this.customerForm.invalid)return;this.saving=!0;let t=this.customerForm.value;this.data?.customer?this.customerService.update(this.data.customer.id,t).subscribe({next:l=>this.dialogRef.close(l),error:()=>this.saving=!1}):this.customerService.create(t).subscribe({next:l=>this.dialogRef.close(l),error:()=>this.saving=!1})}onCancel(){this.dialogRef.close()}static \u0275fac=function(l){return new(l||e)};static \u0275cmp=P({type:e,selectors:[["app-customer-form"]],features:[R([y,b])],decls:83,vars:8,consts:[["mat-dialog-title",""],[1,"customer-form-content"],[3,"formGroup"],["label","General"],[1,"tab-padding"],[1,"form-row"],["appearance","outline",1,"flex-1"],["matInput","","formControlName","name","required","","placeholder","Ej: Juan Perez o Empresa C.A."],[4,"ngIf"],["matInput","","formControlName","taxid","placeholder","V-12345678"],["matInput","","formControlName","searchkey","placeholder","C\xF3digo interno"],["matInput","","formControlName","firstname"],["matInput","","formControlName","lastname"],["formControlName","visible"],["label","Finanzas"],["class","form-row",4,"ngIf"],["matInput","","appMoneyInput","","decimalType","total","formControlName","maxdebt","placeholder","0.00"],["matSuffix",""],["formControlName","discountcategory"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["label","Contacto y Direcci\xF3n"],["matInput","","formControlName","phone","appPhoneFormat",""],["matInput","","formControlName","email","type","email"],["matInput","","formControlName","address","rows","3","placeholder","Direcci\xF3n completa..."],["label","Notas"],["appearance","outline",1,"full-width"],["matInput","","formControlName","notes","rows","6","placeholder","Informaci\xF3n adicional del cliente..."],["align","end"],["mat-button","",3,"click"],["mat-raised-button","","color","primary",3,"disabled","appLoading","click",4,"ngIf"],["appearance","outline",1,"flex-1","info-field"],["matInput","","readonly","",3,"value"],["matPrefix",""],["mat-raised-button","","color","primary",3,"click","disabled","appLoading"]],template:function(l,a){if(l&1&&(n(0,"h2",0),o(1),i(),n(2,"mat-dialog-content",1)(3,"form",2)(4,"mat-tab-group")(5,"mat-tab",3)(6,"div",4)(7,"div",5)(8,"mat-form-field",6)(9,"mat-label"),o(10,"Nombre / Raz\xF3n Social"),i(),p(11,"input",7),c(12,se,2,0,"mat-error",8),i()(),n(13,"div",5)(14,"mat-form-field",6)(15,"mat-label"),o(16,"C\xE9dula / RIF"),i(),p(17,"input",9),i(),n(18,"mat-form-field",6)(19,"mat-label"),o(20,"Clave de B\xFAsqueda"),i(),p(21,"input",10),i()(),n(22,"div",5)(23,"mat-form-field",6)(24,"mat-label"),o(25,"Primer Nombre"),i(),p(26,"input",11),i(),n(27,"mat-form-field",6)(28,"mat-label"),o(29,"Apellidos"),i(),p(30,"input",12),i()(),n(31,"div",5)(32,"mat-checkbox",13),o(33,"Visible en Cat\xE1logo / B\xFAsquedas"),i()()()(),n(34,"mat-tab",14)(35,"div",4),c(36,de,15,8,"div",15),n(37,"div",5)(38,"mat-form-field",6)(39,"mat-label"),o(40,"L\xEDmite de Cr\xE9dito $ (M\xE1x. Deuda)"),i(),p(41,"input",16),n(42,"mat-icon",17),o(43,"credit_card"),i()(),n(44,"mat-form-field",6)(45,"mat-label"),o(46,"Categor\xEDa de Descuento"),i(),n(47,"mat-select",18)(48,"mat-option",19),o(49,"Sin Categor\xEDa"),i(),c(50,ce,2,2,"mat-option",20),i()()()()(),n(51,"mat-tab",21)(52,"div",4)(53,"div",5)(54,"mat-form-field",6)(55,"mat-label"),o(56,"Tel\xE9fono"),i(),p(57,"input",22),n(58,"mat-icon",17),o(59,"phone"),i()(),n(60,"mat-form-field",6)(61,"mat-label"),o(62,"Correo Electr\xF3nico"),i(),p(63,"input",23),n(64,"mat-icon",17),o(65,"email"),i()()(),n(66,"div",5)(67,"mat-form-field",6)(68,"mat-label"),o(69,"Direcci\xF3n"),i(),p(70,"textarea",24),n(71,"mat-icon",17),o(72,"place"),i()()()()(),n(73,"mat-tab",25)(74,"div",4)(75,"mat-form-field",26)(76,"mat-label"),o(77,"Notas / Observaciones"),i(),p(78,"textarea",27),i()()()()()(),n(79,"mat-dialog-actions",28)(80,"button",29),_("click",function(){return a.onCancel()}),o(81),i(),c(82,pe,2,3,"button",30),i()),l&2){let s;r(),F(a.getTitle()),r(2),d("formGroup",a.customerForm),r(9),d("ngIf",(s=a.customerForm.get("name"))==null?null:s.hasError("required")),r(24),d("ngIf",a.data==null?null:a.data.customer),r(12),d("value",null),r(2),d("ngForOf",a.discountCategories),r(31),F(a.data!=null&&a.data.viewOnly?"CERRAR":"CANCELAR"),r(),d("ngIf",!(a.data!=null&&a.data.viewOnly))}},dependencies:[A,$,O,G,yt,L,z,xt,Dt,St,Mt,bt,rt,nt,at,ot,U,q,j,Et,It,W,Z,J,B,V,Q,K,Xt,Kt,Qt,qt,Wt,Y,X,N,Ut,te,Zt,b,y],styles:[".customer-form-content[_ngcontent-%COMP%]{min-width:550px}.tab-padding[_ngcontent-%COMP%]{padding:20px 0;display:flex;flex-direction:column;gap:10px}.form-row[_ngcontent-%COMP%]{display:flex;gap:15px}.flex-1[_ngcontent-%COMP%]{flex:1}.full-width[_ngcontent-%COMP%]{width:100%}textarea[_ngcontent-%COMP%]{resize:vertical}.info-field   [_nghost-%COMP%]     .mat-mdc-text-field-wrapper{background-color:#f5f5f5}"]})}return e})();function fe(e,m){if(e&1&&(n(0,"mat-option",20),o(1),i()),e&2){let t=m.$implicit;d("value",t.value),r(),F(t.label)}}function ue(e,m){if(e&1){let t=I();n(0,"button",21),_("click",function(){u(t);let a=f();return g(a.exportHistory())}),n(1,"mat-icon"),o(2,"picture_as_pdf"),i(),o(3," Exportar "),i()}}function ge(e,m){e&1&&(n(0,"th",37),o(1," Fecha "),i())}function Ce(e,m){if(e&1&&(n(0,"td",38),o(1),w(2,"date"),i()),e&2){let t=m.$implicit;r(),C(" ",S(2,1,t.date,"dd/MM/yyyy HH:mm")," ")}}function _e(e,m){e&1&&(n(0,"th",37),o(1," Pago # "),i())}function he(e,m){if(e&1&&(n(0,"td",38),o(1),i()),e&2){let t=m.$implicit;r(),C(" #",t.ticketNumber," ")}}function xe(e,m){e&1&&(n(0,"th",37),o(1," Factura # "),i())}function ve(e,m){if(e&1&&(n(0,"span"),o(1),i()),e&2){let t=f().$implicit;r(),C("#",t.invoicePaid)}}function ye(e,m){e&1&&(n(0,"span",41),o(1,"-"),i())}function be(e,m){if(e&1&&(n(0,"td",38),c(1,ve,2,1,"span",39)(2,ye,2,0,"span",40),i()),e&2){let t=m.$implicit;r(),d("ngIf",t.invoicePaid),r(),d("ngIf",!t.invoicePaid)}}function Me(e,m){e&1&&(n(0,"th",37),o(1," M\xE9todo "),i())}function De(e,m){if(e&1&&(n(0,"td",38),o(1),i()),e&2){let t=m.$implicit,l=f(2);r(),C(" ",l.getMethodLabel(t.method)," ")}}function we(e,m){e&1&&(n(0,"th",37),o(1," Detalles "),i())}function Se(e,m){if(e&1&&(n(0,"span")(1,"strong"),o(2,"Banco:"),i(),o(3),i()),e&2){let t=f().$implicit;r(3),C(" ",t.bank)}}function Ee(e,m){if(e&1&&(n(0,"span")(1,"strong"),o(2,"Ref:"),i(),o(3),i()),e&2){let t=f().$implicit;r(3),C(" ",t.reference)}}function Ie(e,m){if(e&1&&(n(0,"span")(1,"strong"),o(2,"C\xE9dula:"),i(),o(3),i()),e&2){let t=f().$implicit;r(3),C(" ",t.cedula)}}function Fe(e,m){if(e&1&&(n(0,"td",42),c(1,Se,4,1,"span",39),p(2,"br"),c(3,Ee,4,1,"span",39),p(4,"br"),c(5,Ie,4,1,"span",39),i()),e&2){let t=m.$implicit;r(),d("ngIf",t.bank),r(2),d("ngIf",t.reference),r(2),d("ngIf",t.cedula)}}function Pe(e,m){e&1&&(n(0,"th",37),o(1," Monto "),i())}function Te(e,m){if(e&1&&(n(0,"div",46),o(1),w(2,"number"),i()),e&2){let t=f().$implicit,l=f(2);r(),C(" $ ",S(2,1,t.amount,l.settingsService.getDecimalFormat("total"))," ")}}function He(e,m){if(e&1&&(n(0,"div",47)(1,"small"),o(2),w(3,"number"),i()()),e&2){let t=f().$implicit,l=f(2);r(2),C("IGTF: ",S(3,1,t.igtfAmount,l.settingsService.getDecimalFormat("total"))," Bs.")}}function ke(e,m){if(e&1&&(n(0,"td",43)(1,"strong"),o(2),w(3,"number"),i(),c(4,Te,3,4,"div",44)(5,He,4,4,"div",45),i()),e&2){let t=m.$implicit,l=f(2);r(2),C("",S(3,3,t.amountBs,l.settingsService.getDecimalFormat("total"))," Bs."),r(2),d("ngIf",t.amount!==t.amountBs),r(),d("ngIf",t.igtfAmount>0)}}function Re(e,m){e&1&&(n(0,"th",37),o(1," Acciones "),i())}function $e(e,m){if(e&1){let t=I();n(0,"td",38)(1,"button",48),_("click",function(){let a=u(t).$implicit,s=f(2);return g(s.printPayment(a))}),n(2,"mat-icon"),o(3,"print"),i()()()}}function Oe(e,m){e&1&&p(0,"tr",49)}function Ae(e,m){e&1&&p(0,"tr",50)}function Ne(e,m){if(e&1&&(n(0,"div",22)(1,"table",23),M(2,24),c(3,ge,2,0,"th",25)(4,Ce,3,4,"td",26),D(),M(5,27),c(6,_e,2,0,"th",25)(7,he,2,1,"td",26),D(),M(8,28),c(9,xe,2,0,"th",25)(10,be,3,2,"td",26),D(),M(11,29),c(12,Me,2,0,"th",25)(13,De,2,1,"td",26),D(),M(14,30),c(15,we,2,0,"th",25)(16,Fe,6,3,"td",31),D(),M(17,32),c(18,Pe,2,0,"th",25)(19,ke,6,6,"td",33),D(),M(20,34),c(21,Re,2,0,"th",25)(22,$e,4,0,"td",26),D(),c(23,Oe,1,0,"tr",35)(24,Ae,1,0,"tr",36),i()()),e&2){let t=f();r(),d("dataSource",t.payments),r(22),d("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),r(),d("matRowDefColumns",t.displayedColumns)}}function Ve(e,m){e&1&&(n(0,"div",51)(1,"mat-icon",52),o(2,"history_toggle_off"),i(),n(3,"p"),o(4,"No se registran pagos para este cliente."),i()())}var Fi=(()=>{class e{dialogRef;data;customerService=h(lt);settingsService=h(tt);datePipe=h(y);decimalPipe=h(b);payments=[];displayedColumns=["date","ticketNumber","invoicePaid","method","details","amount","actions"];filterInvoice="";filterMethod="all";filterDate=null;paymentMethods=[{value:"all",label:"Todos"},{value:"cash",label:"Efectivo"},{value:"card",label:"Tarjeta"},{value:"paper",label:"Pago M\xF3vil"},{value:"transfer",label:"Transferencia"}];constructor(t,l){this.dialogRef=t,this.data=l}ngOnInit(){this.loadHistory()}loadHistory(){let t={};this.filterInvoice&&(t.invoice=this.filterInvoice),this.filterMethod&&this.filterMethod!=="all"&&(t.method=this.filterMethod),this.filterDate&&(t.date=this.datePipe.transform(this.filterDate,"yyyy-MM-dd")),this.customerService.getPaymentHistory(this.data.customer.id,t).subscribe(l=>{this.payments=l})}clearFilters(){this.filterInvoice="",this.filterMethod="all",this.filterDate=null,this.loadHistory()}getMethodLabel(t){return{cash:"Efectivo",card:"Tarjeta",paper:"Pago M\xF3vil",Vale:"Pago M\xF3vil",vale:"Pago M\xF3vil",transfer:"Transferencia",debt:"Cr\xE9dito",Credito:"Cr\xE9dito"}[t]||t}printPayment(t){let l=window.open("","_blank","width=400,height=600");if(!l)return;let a=`
            <html>
            <head>
                <title>Comprobante de Pago #${t.ticketNumber}</title>
                <style>
                    body { font-family: 'Courier New', Courier, monospace; font-size: 12px; margin: 10px; }
                    .header { text-align: center; border-bottom: 1px dashed #000; padding-bottom: 10px; margin-bottom: 10px; }
                    .row { display: flex; justify-content: space-between; margin-bottom: 5px; }
                    .footer { text-align: center; margin-top: 20px; font-size: 10px; border-top: 1px dashed #000; padding-top: 10px; }
                    .bold { font-weight: bold; }
                    .title { font-size: 14px; margin-bottom: 5px; }
                </style>
            </head>
            <body>
                <div class="header">
                    <div class="bold title">COMPROBANTE DE PAGO</div>
                    <div>${this.data.customer.name}</div>
                    <div>RIF/CI: ${this.data.customer.taxid||"N/A"}</div>
                </div>
                
                <div class="row"><span class="bold">Nro. Pago:</span> <span>#${t.ticketNumber}</span></div>
                <div class="row"><span class="bold">Fecha:</span> <span>${this.datePipe.transform(t.date,"dd/MM/yyyy HH:mm")}</span></div>
                <div class="row"><span class="bold">Metodo:</span> <span>${this.getMethodLabel(t.method)}</span></div>
                ${t.invoicePaid?`<div class="row"><span class="bold">Abono a Factura:</span> <span>#${t.invoicePaid}</span></div>`:""}
                
                <div style="margin: 15px 0; border-top: 1px solid #000; padding-top: 5px;">
                    ${t.bank?`<div class="row"><span>Banco:</span> <span>${t.bank}</span></div>`:""}
                    ${t.reference?`<div class="row"><span>Ref:</span> <span>${t.reference}</span></div>`:""}
                    ${t.cedula?`<div class="row"><span>C\xE9dula:</span> <span>${t.cedula}</span></div>`:""}
                </div>

                    <div class="row" style="font-size: 14px;">
                    <span class="bold">MONTO PAGADO:</span>
                    <span class="bold">${this.decimalPipe.transform(t.amountBs,this.settingsService.getDecimalFormat("total"))} Bs.</span>
                </div>
                ${t.amount!==t.amountBs?`
                    <div class="row" style="font-size: 12px; font-style: italic; color: #555;">
                        <span>Equivalente:</span>
                        <span>$ ${this.decimalPipe.transform(t.amount,this.settingsService.getDecimalFormat("total"))}</span>
                    </div>
                `:""}
                ${t.igtfAmount>0?`
                    <div class="row" style="font-size: 12px; color: #d32f2f;">
                        <span>I.G.T.F. (3%):</span>
                        <span>${this.decimalPipe.transform(t.igtfAmount,this.settingsService.getDecimalFormat("total"))} Bs.</span>
                    </div>
                `:""}

                <div class="footer">
                    Gracias por su pago.<br>
                    ${this.datePipe.transform(new Date,"dd/MM/yyyy HH:mm")}
                </div>
                <script>window.onload = function() { window.print(); window.close(); }<\/script>
            </body>
            </html>
        `;l.document.write(a),l.document.close()}exportHistory(){let t=window.open("","_blank","width=800,height=600");if(!t)return;let l=this.payments.map(s=>`
            <tr>
                <td>${this.datePipe.transform(s.date,"dd/MM/yyyy HH:mm")}</td>
                <td>#${s.ticketNumber}</td>
                <td>${s.invoicePaid?"#"+s.invoicePaid:"-"}</td>
                <td>${this.getMethodLabel(s.method)}</td>
                <td style="font-size: 10px;">
                    ${s.bank?`<strong>Ban:</strong> ${s.bank}`:""}
                    ${s.reference?`<br><strong>Ref:</strong> ${s.reference}`:""}
                </td>
                <td style="text-align: right; font-weight: bold;">
                    ${this.decimalPipe.transform(s.amountBs,this.settingsService.getDecimalFormat("total"))} Bs.
                    ${s.amount!==s.amountBs?`<br><small style="color: #666;">$ ${this.decimalPipe.transform(s.amount,this.settingsService.getDecimalFormat("total"))}</small>`:""}
                    ${s.igtfAmount>0?`<br><small style="color: #d32f2f;">IGTF: ${this.decimalPipe.transform(s.igtfAmount,this.settingsService.getDecimalFormat("total"))} Bs.</small>`:""}
                </td>
            </tr>
        `).join(""),a=`
            <html>
            <head>
                <title>Historial de Pagos - ${this.data.customer.name}</title>
                <style>
                    body { font-family: Arial, sans-serif; font-size: 12px; }
                    h1 { text-align: center; color: #333; margin-bottom: 5px; }
                    .meta { text-align: center; color: #666; margin-bottom: 20px; }
                    table { width: 100%; border-collapse: collapse; }
                    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                    th { background-color: #f4f4f4; }
                </style>
            </head>
            <body>
                <h1>Historial de Pagos</h1>
                <div class="meta">
                    <strong>Cliente:</strong> ${this.data.customer.name} | 
                    <strong>C\xE9dula/RIF:</strong> ${this.data.customer.taxid||"N/A"}<br>
                    <strong>Generado:</strong> ${this.datePipe.transform(new Date,"dd/MM/yyyy HH:mm")}
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Fecha</th>
                            <th>Nro. Pago</th>
                            <th>Factura</th>
                            <th>M\xE9todo</th>
                            <th>Detalles</th>
                            <th style="text-align: right;">Monto</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${l}
                    </tbody>
                </table>
                <script>window.onload = function() { window.print(); window.close(); }<\/script>
            </body>
            </html>
        `;t.document.write(a),t.document.close()}static \u0275fac=function(l){return new(l||e)(E(et),E(it))};static \u0275cmp=P({type:e,selectors:[["app-cx-c-history-dialog"]],features:[R([y,b,_t()])],decls:39,vars:10,consts:[["picker",""],["empty",""],[1,"history-container"],[1,"header"],["mat-dialog-title",""],[1,"filters-container"],["appearance","outline",1,"filter-field"],["matInput","","placeholder","Ej: 123",3,"ngModelChange","keyup.enter","ngModel"],[3,"ngModelChange","selectionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["matInput","",3,"ngModelChange","dateChange","matDatepicker","ngModel"],["matSuffix","",3,"for"],["mat-icon-button","","color","primary","matTooltip","Buscar",3,"click"],["mat-icon-button","","matTooltip","Limpiar filtros",3,"click"],[1,"header-actions"],["mat-stroked-button","","color","primary",3,"click",4,"ngIf"],["mat-icon-button","",3,"click"],["class","table-container",4,"ngIf","ngIfElse"],["align","end"],["mat-button","",3,"click"],[3,"value"],["mat-stroked-button","","color","primary",3,"click"],[1,"table-container"],["mat-table","",3,"dataSource"],["matColumnDef","date"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","ticketNumber"],["matColumnDef","invoicePaid"],["matColumnDef","method"],["matColumnDef","details"],["mat-cell","","class","details-cell",4,"matCellDef"],["matColumnDef","amount"],["mat-cell","","style","text-align: right;",4,"matCellDef"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],["style","color: #999;",4,"ngIf"],[2,"color","#999"],["mat-cell","",1,"details-cell"],["mat-cell","",2,"text-align","right"],["class","amount-usd",4,"ngIf"],["class","igtf-info",4,"ngIf"],[1,"amount-usd"],[1,"igtf-info"],["mat-icon-button","","color","primary","title","Imprimir Comprobante",3,"click"],["mat-header-row",""],["mat-row",""],[1,"empty-msg"],[2,"font-size","48px","width","48px","height","48px"]],template:function(l,a){if(l&1){let s=I();n(0,"div",2)(1,"div",3)(2,"h2",4),o(3),i(),n(4,"div",5)(5,"mat-form-field",6)(6,"mat-label"),o(7,"Factura #"),i(),n(8,"input",7),k("ngModelChange",function(v){return u(s),H(a.filterInvoice,v)||(a.filterInvoice=v),g(v)}),_("keyup.enter",function(){return u(s),g(a.loadHistory())}),i()(),n(9,"mat-form-field",6)(10,"mat-label"),o(11,"M\xE9todo"),i(),n(12,"mat-select",8),k("ngModelChange",function(v){return u(s),H(a.filterMethod,v)||(a.filterMethod=v),g(v)}),_("selectionChange",function(){return u(s),g(a.loadHistory())}),c(13,fe,2,2,"mat-option",9),i()(),n(14,"mat-form-field",6)(15,"mat-label"),o(16,"Fecha"),i(),n(17,"input",10),k("ngModelChange",function(v){return u(s),H(a.filterDate,v)||(a.filterDate=v),g(v)}),_("dateChange",function(){return u(s),g(a.loadHistory())}),i(),p(18,"mat-datepicker-toggle",11)(19,"mat-datepicker",null,0),i(),n(21,"button",12),_("click",function(){return u(s),g(a.loadHistory())}),n(22,"mat-icon"),o(23,"search"),i()(),n(24,"button",13),_("click",function(){return u(s),g(a.clearFilters())}),n(25,"mat-icon"),o(26,"filter_alt_off"),i()()(),n(27,"div",14),c(28,ue,4,0,"button",15),n(29,"button",16),_("click",function(){return u(s),g(a.dialogRef.close())}),n(30,"mat-icon"),o(31,"close"),i()()()(),n(32,"mat-dialog-content"),c(33,Ne,25,4,"div",17)(34,Ve,5,0,"ng-template",null,1,gt),i(),n(36,"mat-dialog-actions",18)(37,"button",19),_("click",function(){return u(s),g(a.dialogRef.close())}),o(38,"CERRAR"),i()()()}if(l&2){let s=mt(20),x=mt(35);r(3),C("Historial de Pagos - ",a.data.customer.name),r(5),T("ngModel",a.filterInvoice),r(4),T("ngModel",a.filterMethod),r(),d("ngForOf",a.paymentMethods),r(4),d("matDatepicker",s),T("ngModel",a.filterDate),r(),d("for",s),r(10),d("ngIf",a.payments.length>0),r(5),d("ngIf",a.payments.length>0)("ngIfElse",x)}},dependencies:[A,$,O,G,L,z,vt,rt,nt,at,ot,Bt,Pt,Ht,Ot,kt,Tt,At,Rt,$t,Nt,Vt,Q,K,B,V,ht,U,q,j,W,Z,J,Y,X,N,jt,Lt,zt,Gt,Ct,b,y],styles:[".history-container[_ngcontent-%COMP%]{padding:5px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px 15px;border-bottom:1px solid #eee;flex-wrap:wrap;gap:10px}.filters-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;flex:1;justify-content:center}.filter-field[_ngcontent-%COMP%]{font-size:12px;width:140px;margin-bottom:-1.25em}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.mat-mdc-dialog-title[_ngcontent-%COMP%]{margin:0!important;font-size:1.25rem;color:#3f51b5;font-weight:500}.table-container[_ngcontent-%COMP%]{max-height:480px;overflow:auto;margin-top:10px;border:1px solid #f0f0f0;border-radius:4px}table[_ngcontent-%COMP%]{width:100%}th[_ngcontent-%COMP%]{background:#f5f7f9!important;font-weight:600!important;color:#444!important}.details-cell[_ngcontent-%COMP%]{font-size:.85rem;line-height:1.3;color:#666}.details-cell[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#333}.amount-usd[_ngcontent-%COMP%]{font-size:.75rem;color:#2e7d32;font-weight:500;display:block}.empty-msg[_ngcontent-%COMP%]{padding:80px 20px;text-align:center;color:#999;display:flex;flex-direction:column;align-items:center;gap:15px}.empty-msg[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1.1rem}td.mat-cell[_ngcontent-%COMP%]{padding:12px 8px}tr.mat-mdc-row[_ngcontent-%COMP%]:hover{background-color:#fcfcfc}"]})}return e})();export{te as a,mi as b,Fi as c};
