import{a as ce}from"./chunk-2UF7BHSI.js";import"./chunk-TW2J4ZKO.js";import{a as X,b as Y}from"./chunk-UPZQJ6EF.js";import{a as k}from"./chunk-26KDQVR5.js";import"./chunk-DGQM6DPS.js";import{a as Q,b as U}from"./chunk-N5ZCCEPE.js";import{a as Z,b as $,c as ee,d as te,e as ie,f as ne,g as re,h as ae,i as oe,j as le,l as se}from"./chunk-VJGP4MMT.js";import{a as me,b as de}from"./chunk-VNZMNOUU.js";import"./chunk-YCMZOG5D.js";import{a as A,c as K,h as H}from"./chunk-ZWM7H6SC.js";import"./chunk-TEMJ73U5.js";import{d as R}from"./chunk-52A733DE.js";import"./chunk-GPHRSLLH.js";import{b as j,f as z,i as N,j as G}from"./chunk-EWTXOCXT.js";import{f as V,j as W,x as B}from"./chunk-AVLO2MYP.js";import{a as q,b as J}from"./chunk-JI7GBIO6.js";import"./chunk-VTP6RNFS.js";import{I as F,K as D}from"./chunk-M7DMR53X.js";import"./chunk-JAVK727W.js";import"./chunk-3TNWXQYU.js";import"./chunk-UWUK32S4.js";import{k as L,l as O,v as I}from"./chunk-ZD4QWOHN.js";import{$ as E,Fb as s,Gb as t,Hb as i,Ib as h,Mb as S,Nb as M,Pb as w,Ub as P,Wa as o,Wb as c,ea as _,fa as g,gc as b,ic as r,jb as y,jc as T,kc as u,nc as x,oc as C,pb as p,pc as v}from"./chunk-WSMHJDAT.js";import"./chunk-C6Q5SG76.js";function _e(n,m){n&1&&(t(0,"div",5),h(1,"mat-spinner",6),i())}function ge(n,m){if(n&1){let e=w();t(0,"div",11)(1,"mat-icon"),r(2,"print_disabled"),i(),t(3,"p"),r(4,"No se encontraron impresoras configuradas en el sistema."),i(),t(5,"button",12),P("click",function(){_(e);let a=c(2);return g(a.loadData())}),r(6,"Reintentar"),i()()}}function fe(n,m){if(n&1&&(t(0,"mat-option",22),r(1),i()),n&2){let e=m.$implicit;s("value",e.name),o(),u(" ",e.name," ")}}function ue(n,m){if(n&1&&(t(0,"mat-option",22),r(1),i()),n&2){let e=m.$implicit;s("value",e.name),o(),u(" ",e.name," ")}}function xe(n,m){if(n&1&&(t(0,"mat-option",22),r(1),i()),n&2){let e=m.$implicit;s("value",e.name),o(),u(" ",e.name," ")}}function Ce(n,m){if(n&1){let e=w();t(0,"div",13)(1,"h3"),r(2,"Asignaci\xF3n de Roles"),i(),t(3,"div",14)(4,"div",15)(5,"mat-form-field",16)(6,"mat-label"),r(7,"Comandas / Tickets"),i(),t(8,"mat-select",17),v("ngModelChange",function(a){_(e);let l=c(2);return C(l.settings.roles.TICKET.name,a)||(l.settings.roles.TICKET.name=a),g(a)}),t(9,"mat-option",18),r(10,"-- Predeterminada --"),i(),p(11,fe,2,2,"mat-option",19),i(),t(12,"mat-icon",20),r(13,"receipt"),i()(),t(14,"mat-form-field",21)(15,"mat-label"),r(16,"Ancho"),i(),t(17,"mat-select",17),v("ngModelChange",function(a){_(e);let l=c(2);return C(l.settings.roles.TICKET.width,a)||(l.settings.roles.TICKET.width=a),g(a)}),t(18,"mat-option",22),r(19,"58mm"),i(),t(20,"mat-option",22),r(21,"76mm"),i(),t(22,"mat-option",22),r(23,"80mm"),i()()()(),t(24,"div",15)(25,"mat-form-field",16)(26,"mat-label"),r(27,"Facturas Fiscales"),i(),t(28,"mat-select",17),v("ngModelChange",function(a){_(e);let l=c(2);return C(l.settings.roles.FISCAL.name,a)||(l.settings.roles.FISCAL.name=a),g(a)}),t(29,"mat-option",18),r(30,"-- Predeterminada --"),i(),p(31,ue,2,2,"mat-option",19),i(),t(32,"mat-icon",20),r(33,"gavel"),i()(),t(34,"mat-form-field",21)(35,"mat-label"),r(36,"Ancho"),i(),t(37,"mat-select",17),v("ngModelChange",function(a){_(e);let l=c(2);return C(l.settings.roles.FISCAL.width,a)||(l.settings.roles.FISCAL.width=a),g(a)}),t(38,"mat-option",22),r(39,"58mm"),i(),t(40,"mat-option",22),r(41,"76mm"),i(),t(42,"mat-option",22),r(43,"80mm"),i()()()(),t(44,"div",15)(45,"mat-form-field",16)(46,"mat-label"),r(47,"Reportes / Cierre"),i(),t(48,"mat-select",17),v("ngModelChange",function(a){_(e);let l=c(2);return C(l.settings.roles.REPORT.name,a)||(l.settings.roles.REPORT.name=a),g(a)}),t(49,"mat-option",18),r(50,"-- Predeterminada --"),i(),p(51,xe,2,2,"mat-option",19),i(),t(52,"mat-icon",20),r(53,"assessment"),i()(),t(54,"mat-form-field",21)(55,"mat-label"),r(56,"Ancho"),i(),t(57,"mat-select",17),v("ngModelChange",function(a){_(e);let l=c(2);return C(l.settings.roles.REPORT.width,a)||(l.settings.roles.REPORT.width=a),g(a)}),t(58,"mat-option",22),r(59,"58mm"),i(),t(60,"mat-option",22),r(61,"76mm"),i(),t(62,"mat-option",22),r(63,"80mm"),i()()()()(),t(64,"div",23)(65,"button",24),P("click",function(){_(e);let a=c(2);return g(a.saveSettings())}),t(66,"mat-icon"),r(67,"save"),i(),r(68),i()(),h(69,"mat-divider",25),i()}if(n&2){let e=c(2);o(8),x("ngModel",e.settings.roles.TICKET.name),o(3),s("ngForOf",e.printers),o(6),x("ngModel",e.settings.roles.TICKET.width),o(),s("value",58),o(2),s("value",76),o(2),s("value",80),o(6),x("ngModel",e.settings.roles.FISCAL.name),o(3),s("ngForOf",e.printers),o(6),x("ngModel",e.settings.roles.FISCAL.width),o(),s("value",58),o(2),s("value",76),o(2),s("value",80),o(6),x("ngModel",e.settings.roles.REPORT.name),o(3),s("ngForOf",e.printers),o(6),x("ngModel",e.settings.roles.REPORT.width),o(),s("value",58),o(2),s("value",76),o(2),s("value",80),o(3),s("disabled",e.saving),o(3),u(" ",e.saving?"Guardando...":"Guardar Configuraci\xF3n"," ")}}function ve(n,m){n&1&&(t(0,"th",35),r(1," Nombre "),i())}function he(n,m){if(n&1&&(t(0,"td",36)(1,"strong"),r(2),i()()),n&2){let e=m.$implicit;o(2),T(e.name)}}function Se(n,m){n&1&&(t(0,"th",35),r(1," Controlador "),i())}function Me(n,m){if(n&1&&(t(0,"td",36),r(1),i()),n&2){let e=m.$implicit;o(),u(" ",e.driver," ")}}function we(n,m){n&1&&(t(0,"th",35),r(1," Estado "),i())}function Pe(n,m){if(n&1&&(t(0,"td",36)(1,"span",37),r(2),i()()),n&2){let e=m.$implicit;o(),b("ready",e.status==="Ready"),o(),u(" ",e.status," ")}}function Ee(n,m){n&1&&(t(0,"th",35),r(1," Acciones "),i())}function ye(n,m){if(n&1){let e=w();t(0,"td",36)(1,"button",38),P("click",function(){let a=_(e).$implicit,l=c(3);return g(l.testPrinter(a.name))}),t(2,"mat-icon"),r(3,"print"),i(),r(4," Prueba "),i()()}}function be(n,m){n&1&&h(0,"tr",39)}function Te(n,m){n&1&&h(0,"tr",40)}function Le(n,m){if(n&1&&(t(0,"table",26),S(1,27),p(2,ve,2,0,"th",28)(3,he,3,1,"td",29),M(),S(4,30),p(5,Se,2,0,"th",28)(6,Me,2,1,"td",29),M(),S(7,31),p(8,we,2,0,"th",28)(9,Pe,3,3,"td",29),M(),S(10,32),p(11,Ee,2,0,"th",28)(12,ye,5,0,"td",29),M(),p(13,be,1,0,"tr",33)(14,Te,1,0,"tr",34),i()),n&2){let e=c(2);s("dataSource",e.printers),o(13),s("matHeaderRowDef",e.displayedColumns),o(),s("matRowDefColumns",e.displayedColumns)}}function Oe(n,m){if(n&1&&(t(0,"div",7)(1,"mat-card")(2,"mat-card-content"),p(3,ge,7,0,"div",8)(4,Ce,70,20,"div",9)(5,Le,15,3,"table",10),i()()()),n&2){let e=c();o(3),s("ngIf",e.printers.length===0),o(),s("ngIf",e.printers.length>0),o(),s("ngIf",e.printers.length>0)}}var it=(()=>{class n{printerService=E(ce);snackBar=E(k);printers=[];settings={roles:{TICKET:{name:"",width:80},FISCAL:{name:"",width:80},REPORT:{name:"",width:80}}};loading=!0;saving=!1;displayedColumns=["name","driver","status","actions"];ngOnInit(){this.loadData()}loadData(){this.loading=!0,this.printerService.getPrinters().subscribe({next:e=>{this.printers=e,this.loadSettings()},error:e=>{console.error("Error loading printers:",e),this.loading=!1,e.error&&this.snackBar.open(e.error,"Cerrar",{duration:3e3})}})}loadSettings(){this.printerService.getPrinterSettings().subscribe({next:e=>{e&&e.roles&&(["TICKET","FISCAL","REPORT"].forEach(a=>{let l=e.roles[a];typeof l=="string"?e.roles[a]={name:l,width:80}:l?l.width||(l.width=80):e.roles[a]={name:"",width:80}}),this.settings=e),this.loading=!1},error:e=>{console.error("Error loading settings:",e),this.loading=!1}})}saveSettings(){this.saving=!0,this.printerService.savePrinterSettings(this.settings).subscribe({next:()=>{this.snackBar.open("Configuraci\xF3n guardada correctamente","OK",{duration:3e3}),this.saving=!1},error:e=>{console.error("Error saving settings:",e),this.snackBar.open("Error al guardar configuraci\xF3n","Cerrar",{duration:3e3}),this.saving=!1}})}testPrinter(e){this.snackBar.open(`Enviando prueba a ${e}...`,"OK",{duration:2e3});let d=80,l=Object.values(this.settings.roles).find(f=>f.name===e);l&&(d=l.width),this.printerService.testPrinter(e,d).subscribe({next:f=>{f.success?this.snackBar.open(`Prueba enviada con \xE9xito a ${e}`,"OK",{duration:3e3}):this.snackBar.open(`Error en prueba: ${f.error}`,"Cerrar",{duration:5e3})},error:f=>{console.error("Error in test print:",f);let pe=f.error?.error||"Error de conexi\xF3n con el servidor de impresi\xF3n";this.snackBar.open(pe,"Cerrar",{duration:5e3})}})}static \u0275fac=function(d){return new(d||n)};static \u0275cmp=y({type:n,selectors:[["app-printers-list"]],decls:8,vars:2,consts:[[1,"printers-container"],[1,"header"],[1,"subtitle"],["class","spinner-container",4,"ngIf"],["class","content",4,"ngIf"],[1,"spinner-container"],["diameter","40"],[1,"content"],["class","empty-state",4,"ngIf"],["class","roles-section",4,"ngIf"],["mat-table","",3,"dataSource",4,"ngIf"],[1,"empty-state"],["mat-stroked-button","",3,"click"],[1,"roles-section"],[1,"roles-grid"],[1,"role-item"],["appearance","outline"],[3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["matSuffix",""],["appearance","outline",1,"width-select"],[3,"value"],[1,"actions-row"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"spacer"],["mat-table","",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","driver"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"status-badge"],["mat-button","","color","primary",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(d,a){d&1&&(t(0,"div",0)(1,"div",1)(2,"h1"),r(3,"Configuraci\xF3n de Impresoras"),i(),t(4,"p",2),r(5,"Lista de impresoras detectadas en el servidor"),i()(),p(6,_e,2,0,"div",3)(7,Oe,6,3,"div",4),i()),d&2&&(o(6),s("ngIf",a.loading),o(),s("ngIf",!a.loading))},dependencies:[I,L,O,B,V,W,H,A,K,D,F,J,q,se,Z,ee,re,te,$,ae,ie,ne,oe,le,U,Q,de,N,j,z,me,R,G,Y,X],styles:[".printers-container[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto}.header[_ngcontent-%COMP%]{margin-bottom:24px}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:24px;font-weight:500}.subtitle[_ngcontent-%COMP%]{margin:8px 0 0;color:#666}.spinner-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:48px}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:16px;padding:48px;color:#666}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px}table[_ngcontent-%COMP%]{width:100%}.status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;background-color:#eee;color:#666;font-size:12px;font-weight:500}.status-badge.ready[_ngcontent-%COMP%]{background-color:#e8f5e9;color:#2e7d32}.roles-section[_ngcontent-%COMP%]{padding:16px 0}.roles-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;font-size:18px;font-weight:500;color:#333}.roles-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:16px;margin-bottom:24px}.role-item[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:flex-start;margin-bottom:8px}.role-item[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:2}.role-item[_ngcontent-%COMP%]   .width-select[_ngcontent-%COMP%]{flex:1;min-width:100px}.actions-row[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-bottom:16px}.spacer[_ngcontent-%COMP%]{margin:24px 0}mat-form-field[_ngcontent-%COMP%]{width:100%}"]})}return n})();export{it as PrintersListComponent};
