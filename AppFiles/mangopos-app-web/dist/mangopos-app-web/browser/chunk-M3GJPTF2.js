import{a as ce,b as de}from"./chunk-O2W4PKCN.js";import{a as me}from"./chunk-DEAF3FKS.js";import{a as ae}from"./chunk-7KQW3R3P.js";import{a as se}from"./chunk-RFRKPPY3.js";import{a as F,b as O}from"./chunk-26KDQVR5.js";import{a as le}from"./chunk-DGQM6DPS.js";import"./chunk-EQXJNMRX.js";import{b as ee,c as te}from"./chunk-APXOZHQA.js";import{a as oe,b as re}from"./chunk-VNZMNOUU.js";import"./chunk-YCMZOG5D.js";import{a as q,b as z,c as R,d as U,e as H,f as Z,h as J}from"./chunk-ZWM7H6SC.js";import"./chunk-TEMJ73U5.js";import{d as T}from"./chunk-52A733DE.js";import"./chunk-GPHRSLLH.js";import{b as K,d as Q,f as X,i as Y,j as $}from"./chunk-EWTXOCXT.js";import{b as k,f as L,j as D,l as A,s as j,t as G,x as N}from"./chunk-AVLO2MYP.js";import{a as ne,b as ie}from"./chunk-JI7GBIO6.js";import"./chunk-VTP6RNFS.js";import{I as P,K as B}from"./chunk-M7DMR53X.js";import"./chunk-JAVK727W.js";import"./chunk-3TNWXQYU.js";import"./chunk-UWUK32S4.js";import{k as W,l as I,v as V}from"./chunk-ZD4QWOHN.js";import{Fb as u,Gb as i,Hb as n,Pb as x,Ub as h,Wa as r,Wb as d,db as y,ea as m,fa as c,ic as o,jb as E,jc as b,kc as M,lc as v,nc as g,oc as _,pb as C,pc as p}from"./chunk-WSMHJDAT.js";import{a as S,b as w}from"./chunk-C6Q5SG76.js";function ge(s,f){if(s&1){let e=x();i(0,"mat-form-field",29)(1,"mat-label"),o(2,"Porcentaje IGTF (%)"),n(),i(3,"input",30),p("ngModelChange",function(t){m(e);let a=d(2);return _(a.settings.igtf_percentage,t)||(a.settings.igtf_percentage=t),c(t)}),n(),i(4,"span",31),o(5,"%"),n()()}if(s&2){let e=d(2);r(3),g("ngModel",e.settings.igtf_percentage)}}function _e(s,f){if(s&1&&(i(0,"mat-option",33),o(1),n()),s&2){let e=f.$implicit;u("value",e.id),r(),v(" ",e.name," (",e.type.toUpperCase(),") ")}}function pe(s,f){if(s&1){let e=x();i(0,"mat-form-field",6)(1,"mat-label"),o(2,"Almac\xE9n Asociado"),n(),i(3,"mat-select",20),p("ngModelChange",function(t){m(e);let a=d(2);return _(a.selectedWarehouseId,t)||(a.selectedWarehouseId=t),c(t)}),C(4,_e,2,3,"mat-option",32),n(),i(5,"mat-hint"),o(6,"Almac\xE9n que usar\xE1 este terminal para stock y cat\xE1logo"),n()()}if(s&2){let e=d(2);r(3),g("ngModel",e.selectedWarehouseId),r(),u("ngForOf",e.warehouses)}}function ue(s,f){s&1&&(i(0,"mat-hint"),o(1,"Moneda Base (Fija)"),n())}function fe(s,f){if(s&1){let e=x();i(0,"div",34)(1,"div",35)(2,"strong"),o(3),n(),o(4),n(),i(5,"div",5)(6,"mat-form-field",6)(7,"mat-label"),o(8,"Nombre"),n(),i(9,"input",11),p("ngModelChange",function(t){let a=m(e).$implicit;return _(a.name,t)||(a.name=t),c(t)}),n()(),i(10,"mat-form-field",6)(11,"mat-label"),o(12,"S\xEDmbolo"),n(),i(13,"input",11),p("ngModelChange",function(t){let a=m(e).$implicit;return _(a.symbol,t)||(a.symbol=t),c(t)}),n()(),i(14,"mat-form-field",6)(15,"mat-label"),o(16),n(),i(17,"input",36),p("ngModelChange",function(t){let a=m(e).$implicit;return _(a.exchange_rate,t)||(a.exchange_rate=t),c(t)}),n(),C(18,ue,2,0,"mat-hint",1),n(),i(19,"button",37),h("click",function(){let t=m(e).$implicit,a=d(2);return c(a.saveCurrency(t))}),o(20," ACTUALIZAR "),n()()()}if(s&2){let e=f.$implicit;r(3),b(e.code),r(),M(" - ",e.name," "),r(5),g("ngModel",e.name),r(4),g("ngModel",e.symbol),r(3),M("Tasa de Cambio (1 ",e.code," = ? Bs.)"),r(),g("ngModel",e.exchange_rate),u("disabled",e.is_base),r(),u("ngIf",e.is_base)}}function Ce(s,f){if(s&1){let e=x();i(0,"mat-card-content")(1,"div",4)(2,"h3"),o(3,"Decimales y Precisi\xF3n"),n(),i(4,"div",5)(5,"mat-form-field",6)(6,"mat-label"),o(7,"Decimales en Precios"),n(),i(8,"input",7),p("ngModelChange",function(t){m(e);let a=d();return _(a.settings.price_decimals,t)||(a.settings.price_decimals=t),c(t)}),n(),i(9,"mat-hint"),o(10,"Ej: 2 -> 1,23 | 3 -> 1,234"),n()(),i(11,"mat-form-field",6)(12,"mat-label"),o(13,"Decimales en Totales"),n(),i(14,"input",7),p("ngModelChange",function(t){m(e);let a=d();return _(a.settings.total_decimals,t)||(a.settings.total_decimals=t),c(t)}),n()(),i(15,"mat-form-field",6)(16,"mat-label"),o(17,"Decimales en Cantidades"),n(),i(18,"input",7),p("ngModelChange",function(t){m(e);let a=d();return _(a.settings.quantity_decimals,t)||(a.settings.quantity_decimals=t),c(t)}),n()(),i(19,"mat-form-field",6)(20,"mat-label"),o(21,"Decimales en Porcentaje"),n(),i(22,"input",7),p("ngModelChange",function(t){m(e);let a=d();return _(a.settings.percentage_decimals,t)||(a.settings.percentage_decimals=t),c(t)}),n(),i(23,"mat-hint"),o(24,"Ej: 0 -> 10% | 2 -> 10,00%"),n()()()(),i(25,"div",4)(26,"h3"),o(27,"Moneda y Empresa"),n(),i(28,"div",5)(29,"mat-form-field",6)(30,"mat-label"),o(31,"S\xEDmbolo de Moneda"),n(),i(32,"input",8),p("ngModelChange",function(t){m(e);let a=d();return _(a.settings.currency_symbol,t)||(a.settings.currency_symbol=t),c(t)}),n()(),i(33,"mat-form-field",6)(34,"mat-label"),o(35,"C\xF3digo de Moneda"),n(),i(36,"input",9),p("ngModelChange",function(t){m(e);let a=d();return _(a.settings.currency_code,t)||(a.settings.currency_code=t),c(t)}),n()(),i(37,"mat-form-field",10)(38,"mat-label"),o(39,"Nombre de la Empresa"),n(),i(40,"input",11),p("ngModelChange",function(t){m(e);let a=d();return _(a.settings.company_name,t)||(a.settings.company_name=t),c(t)}),n()(),i(41,"mat-form-field",10)(42,"mat-label"),o(43,"Direcci\xF3n"),n(),i(44,"textarea",12),p("ngModelChange",function(t){m(e);let a=d();return _(a.settings.company_address,t)||(a.settings.company_address=t),c(t)}),n()(),i(45,"div",13)(46,"mat-slide-toggle",14),p("ngModelChange",function(t){m(e);let a=d();return _(a.settings.enable_pdf_ticket,t)||(a.settings.enable_pdf_ticket=t),c(t)}),o(47," Mostrar ticket PDF si falla impresora t\xE9rmica "),n(),i(48,"mat-hint",15),o(49," Si se activa, se mostrar\xE1 el di\xE1logo de impresi\xF3n del navegador cuando la impresora t\xE9rmica no est\xE9 conectada. "),n()()()(),i(50,"div",4)(51,"h3"),o(52,"Impuestos y Fiscalidad (IGTF)"),n(),i(53,"div",16)(54,"div",17)(55,"mat-slide-toggle",18),p("ngModelChange",function(t){m(e);let a=d();return _(a.settings.igtf_enabled,t)||(a.settings.igtf_enabled=t),c(t)}),o(56," Habilitar cobro de IGTF en pagos en Divisas "),n()(),C(57,ge,6,1,"mat-form-field",19),n(),i(58,"mat-hint",15),o(59," El IGTF se aplicar\xE1 autom\xE1ticamente sobre el monto recibido en moneda extranjera (USD). "),n()(),i(60,"div",4)(61,"h3"),o(62,"Apariencia y POS"),n(),i(63,"div",5)(64,"mat-form-field",6)(65,"mat-label"),o(66,"Dise\xF1o del Punto de Venta"),n(),i(67,"mat-select",20),p("ngModelChange",function(t){m(e);let a=d();return _(a.settings.pos_layout,t)||(a.settings.pos_layout=t),c(t)}),i(68,"mat-option",21),o(69,"Cl\xE1sico (Tablas y Listas)"),n(),i(70,"mat-option",22),o(71,"Moderno (Cuadr\xEDcula y Visual)"),n()(),i(72,"mat-hint"),o(73,"Cambia la apariencia de la pantalla de ventas"),n()(),i(74,"mat-form-field",10)(75,"mat-label"),o(76,"Servidor de Impresi\xF3n (Thermal)"),n(),i(77,"input",23),p("ngModelChange",function(t){m(e);let a=d();return _(a.settings.print_server_url,t)||(a.settings.print_server_url=t),c(t)}),n(),i(78,"mat-hint"),o(79,"URL del servidor de impresi\xF3n t\xE9rmica (ej: http://localhost:3001/api)"),n()(),i(80,"mat-form-field",6)(81,"mat-label"),o(82,"Tipo de Instalaci\xF3n"),n(),i(83,"mat-select",20),p("ngModelChange",function(t){m(e);let a=d();return _(a.currInstallationType,t)||(a.currInstallationType=t),c(t)}),i(84,"mat-option",24),o(85,"Instalaci\xF3n en F\xE1brica (Distribuidor)"),n(),i(86,"mat-option",25),o(87,"Punto de Venta (Receptor)"),n()(),i(88,"mat-hint"),o(89,"Define qu\xE9 funciones de distribuci\xF3n estar\xE1n disponibles"),n()(),C(90,pe,7,2,"mat-form-field",26),n()(),i(91,"div",27)(92,"h3"),o(93,"Monedas y Tasas de Cambio (Basado en Bs.)"),n(),C(94,fe,21,8,"div",28),n()()}if(s&2){let e=d();r(8),g("ngModel",e.settings.price_decimals),r(6),g("ngModel",e.settings.total_decimals),r(4),g("ngModel",e.settings.quantity_decimals),r(4),g("ngModel",e.settings.percentage_decimals),r(10),g("ngModel",e.settings.currency_symbol),r(4),g("ngModel",e.settings.currency_code),r(4),g("ngModel",e.settings.company_name),r(4),g("ngModel",e.settings.company_address),r(2),g("ngModel",e.settings.enable_pdf_ticket),r(9),g("ngModel",e.settings.igtf_enabled),r(2),u("ngIf",e.settings.igtf_enabled),r(10),g("ngModel",e.settings.pos_layout),r(10),g("ngModel",e.settings.print_server_url),r(6),g("ngModel",e.currInstallationType),r(7),u("ngIf",e.warehouses.length>0),r(4),u("ngForOf",e.currencies)}}var Qe=(()=>{class s{settingsService;appConfigService;warehouseService;snackBar;settings={price_decimals:2,total_decimals:2,quantity_decimals:3,currency_symbol:"Bs.",currency_code:"VES",company_name:"",company_address:"",enable_pdf_ticket:!1,percentage_decimals:0,pos_layout:"classic",print_server_url:"http://localhost:3001/api",igtf_enabled:!1,igtf_percentage:3};currencies=[];loading=!0;currInstallationType="pos";warehouses=[];selectedWarehouseId=null;constructor(e,l,t,a){this.settingsService=e,this.appConfigService=l,this.warehouseService=t,this.snackBar=a}ngOnInit(){this.loadSettings();let e=this.appConfigService.getConfig();this.currInstallationType=e?.installation_type||"pos",this.selectedWarehouseId=e?.warehouse_id||null,this.loadWarehouses()}async loadSettings(){try{let e=await this.settingsService.loadSettings();e&&(this.settings=S({},e)),this.loadCurrencies()}catch{this.snackBar.open("Error al cargar configuraci\xF3n","Cerrar",{duration:3e3})}finally{this.loading=!1}}loadCurrencies(){this.settingsService.getCurrencies().subscribe(e=>{this.currencies=e})}loadWarehouses(){this.warehouseService.getAll().subscribe(e=>{this.warehouses=e})}async saveCurrency(e){try{await this.settingsService.updateCurrency(e.id,{exchange_rate:e.exchange_rate,symbol:e.symbol,name:e.name,active:e.active}),this.snackBar.open(`Moneda ${e.code} actualizada`,"Cerrar",{duration:2e3})}catch{this.snackBar.open("Error al actualizar moneda","Cerrar",{duration:3e3})}}async saveSettings(){try{await this.settingsService.updateSettings(this.settings),this.appConfigService.setConfig(w(S({},this.appConfigService.getConfig()),{installation_type:this.currInstallationType,location_name:this.settings.company_name||"Generic Location",warehouse_id:this.selectedWarehouseId||void 0})),this.snackBar.open("Configuraci\xF3n guardada exitosamente","Cerrar",{duration:3e3}),setTimeout(()=>window.location.reload(),1e3)}catch{this.snackBar.open("Error al guardar configuraci\xF3n","Cerrar",{duration:3e3})}}static \u0275fac=function(l){return new(l||s)(y(le),y(ae),y(me),y(F))};static \u0275cmp=E({type:s,selectors:[["app-settings"]],decls:13,vars:1,consts:[[1,"settings-container"],[4,"ngIf"],["align","end"],["mat-flat-button","","color","primary",3,"click"],[1,"settings-section"],[1,"grid-row"],["appearance","outline"],["matInput","","type","number","min","0","max","6",3,"ngModelChange","ngModel"],["matInput","","placeholder","Bs.",3,"ngModelChange","ngModel"],["matInput","","placeholder","VES",3,"ngModelChange","ngModel"],["appearance","outline",1,"full-width"],["matInput","",3,"ngModelChange","ngModel"],["matInput","","rows","2",3,"ngModelChange","ngModel"],[1,"toggle-container",2,"margin-top","10px"],["color","primary",3,"ngModelChange","ngModel"],[1,"toggle-hint",2,"display","block","margin-top","5px","font-size","12px","color","#666"],[1,"grid-row",2,"align-items","center","gap","40px"],[1,"toggle-container"],["color","warn",3,"ngModelChange","ngModel"],["appearance","outline","style","width: 150px;",4,"ngIf"],[3,"ngModelChange","ngModel"],["value","classic"],["value","modern"],["matInput","","placeholder","http://localhost:3001/api",3,"ngModelChange","ngModel"],["value","factory"],["value","pos"],["appearance","outline",4,"ngIf"],[1,"settings-section","currencies-section"],["class","currency-item",4,"ngFor","ngForOf"],["appearance","outline",2,"width","150px"],["matInput","","type","number","min","0","max","100",3,"ngModelChange","ngModel"],["matSuffix",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"currency-item"],[1,"curr-header"],["matInput","","type","text","appMoneyInput","","decimalType","price",3,"ngModelChange","ngModel","disabled"],["mat-stroked-button","","color","accent",3,"click"]],template:function(l,t){l&1&&(i(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),o(4,"Configuraci\xF3n General"),n(),i(5,"mat-card-subtitle"),o(6,"Ajustes regionales y visuales de la aplicaci\xF3n"),n()(),C(7,Ce,95,16,"mat-card-content",1),i(8,"mat-card-actions",2)(9,"button",3),h("click",function(){return t.saveSettings()}),i(10,"mat-icon"),o(11,"save"),n(),o(12," GUARDAR CAMBIOS "),n()()()()),l&2&&(r(7),u("ngIf",!t.loading))},dependencies:[V,W,I,N,k,A,L,G,j,D,J,q,H,R,Z,U,z,$,Y,K,Q,X,te,ee,B,P,ie,ne,O,de,ce,re,oe,T,se],styles:[".settings-container[_ngcontent-%COMP%]{padding:24px;max-width:800px;margin:0 auto}.settings-section[_ngcontent-%COMP%]{margin-bottom:32px}.settings-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:20px;color:#333;font-weight:600;border-bottom:1px solid #eee;padding-bottom:8px}.grid-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:16px}.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}mat-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 4px 20px #00000014!important}mat-card-header[_ngcontent-%COMP%]{margin-bottom:24px}mat-card-title[_ngcontent-%COMP%]{font-size:1.5rem!important;font-weight:700!important;color:#6200ee}mat-card-actions[_ngcontent-%COMP%]{padding:16px!important;border-top:1px solid #eee}button[mat-flat-button][_ngcontent-%COMP%]{padding:0 24px;height:48px;font-weight:600}button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.currency-item[_ngcontent-%COMP%]{background:#f9f9f9;padding:16px;border-radius:8px;margin-bottom:20px}.curr-header[_ngcontent-%COMP%]{margin-bottom:12px;font-size:1rem;color:#6200ee}.currency-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;align-self:start}"]})}return s})();export{Qe as SettingsComponent};
