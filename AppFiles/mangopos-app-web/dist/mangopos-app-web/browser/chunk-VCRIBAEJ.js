import{a as ut}from"./chunk-VALAE6MC.js";import{a as dt}from"./chunk-34EVCEMG.js";import{a as at,b as rt,c as mt,e as lt,f as ct,g as st,h as y}from"./chunk-Z6YHTX75.js";import{a as F,b as I}from"./chunk-26KDQVR5.js";import{b as q,c as z}from"./chunk-APXOZHQA.js";import{a as Q,b as U,c as W,d as X,e as Y,f as Z,g as tt,h as et,i as it,j as ot,l as nt}from"./chunk-VJGP4MMT.js";import"./chunk-YCMZOG5D.js";import"./chunk-TEMJ73U5.js";import{b as G,c as O,i as P,j as $}from"./chunk-EWTXOCXT.js";import{b as R,d as T,f as B,g as L,k as N,n as j,o as V,w as A,y as H}from"./chunk-AVLO2MYP.js";import{a as J,b as K}from"./chunk-JI7GBIO6.js";import"./chunk-VTP6RNFS.js";import{H as k,I as D,K as M}from"./chunk-M7DMR53X.js";import"./chunk-JAVK727W.js";import"./chunk-3TNWXQYU.js";import"./chunk-UWUK32S4.js";import{l as w,v as _}from"./chunk-ZD4QWOHN.js";import{Fb as s,Gb as o,Hb as a,Ib as f,Mb as v,Nb as S,Pb as E,Ub as u,Wa as l,Wb as x,db as c,ea as b,fa as h,ic as r,jb as g,kc as C,pb as p}from"./chunk-WSMHJDAT.js";import"./chunk-C6Q5SG76.js";function _t(e,d){e&1&&(o(0,"mat-error"),r(1,"El nombre es requerido"),a())}var pt=(()=>{class e{fb;dialogRef;data;form;constructor(i,n,t){this.fb=i,this.dialogRef=n,this.data=t,this.form=this.fb.group({name:[t.category?.name||"",T.required]})}onSubmit(){this.form.valid&&this.dialogRef.close(this.form.value)}onCancel(){this.dialogRef.close()}static \u0275fac=function(n){return new(n||e)(c(A),c(at),c(rt))};static \u0275cmp=g({type:e,selectors:[["app-discount-category-form"]],decls:15,vars:4,consts:[["mat-dialog-title",""],[3,"ngSubmit","formGroup"],[1,"form-container"],["appearance","outline"],["matInput","","formControlName","name","placeholder","Ej. Licores"],[4,"ngIf"],["align","end"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(n,t){if(n&1&&(o(0,"h2",0),r(1),a(),o(2,"form",1),u("ngSubmit",function(){return t.onSubmit()}),o(3,"mat-dialog-content")(4,"div",2)(5,"mat-form-field",3)(6,"mat-label"),r(7,"Nombre"),a(),f(8,"input",4),p(9,_t,2,0,"mat-error",5),a()()(),o(10,"mat-dialog-actions",6)(11,"button",7),u("click",function(){return t.onCancel()}),r(12,"Cancelar"),a(),o(13,"button",8),r(14,"Guardar"),a()()()),n&2){let m;l(),C("",t.data.category?"Editar":"Nueva"," Categor\xEDa"),l(),s("formGroup",t.form),l(7),s("ngIf",(m=t.form.get("name"))==null?null:m.hasError("required")),l(4),s("disabled",t.form.invalid)}},dependencies:[_,w,H,N,R,B,L,V,j,y,lt,st,ct,$,P,G,O,z,q,M,D],styles:[".form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;min-width:300px;padding-top:10px}"]})}return e})();function Dt(e,d){e&1&&(o(0,"th",10),r(1," Nombre "),a())}function Mt(e,d){if(e&1&&(o(0,"td",11),r(1),a()),e&2){let i=d.$implicit;l(),C(" ",i.name," ")}}function yt(e,d){e&1&&(o(0,"th",10),r(1," Acciones "),a())}function bt(e,d){if(e&1){let i=E();o(0,"td",11)(1,"button",12),u("click",function(){let t=b(i).$implicit,m=x();return h(m.openForm(t))}),o(2,"mat-icon"),r(3,"edit"),a()(),o(4,"button",13),u("click",function(){let t=b(i).$implicit,m=x();return h(m.deleteCategory(t))}),o(5,"mat-icon"),r(6,"delete"),a()()()}}function ht(e,d){e&1&&f(0,"tr",14)}function vt(e,d){e&1&&f(0,"tr",15)}var Zt=(()=>{class e{discountService;dialog;snackBar;categories=[];displayedColumns=["name","actions"];constructor(i,n,t){this.discountService=i,this.dialog=n,this.snackBar=t}ngOnInit(){this.getCategories()}getCategories(){this.discountService.getDiscountCategories().subscribe(i=>{this.categories=i})}openForm(i){this.dialog.open(pt,{width:"400px",data:{category:i}}).afterClosed().subscribe(t=>{t&&(i?this.discountService.updateDiscountCategory(i.id,t).subscribe(()=>{this.snackBar.open("Categor\xEDa actualizada","Cerrar",{duration:3e3}),this.getCategories()}):this.discountService.createDiscountCategory(t).subscribe(()=>{this.snackBar.open("Categor\xEDa creada","Cerrar",{duration:3e3}),this.getCategories()}))})}deleteCategory(i){this.dialog.open(ut,{data:{title:"Confirmar eliminaci\xF3n",message:`\xBFEst\xE1 seguro de eliminar la categor\xEDa "${i.name}"?`}}).afterClosed().subscribe(t=>{t&&this.discountService.deleteDiscountCategory(i.id).subscribe(()=>{this.snackBar.open("Categor\xEDa eliminada","Cerrar",{duration:3e3}),this.getCategories()},m=>{this.snackBar.open("No se puede eliminar: tiene descuentos asociados","Cerrar",{duration:4e3})})})}static \u0275fac=function(n){return new(n||e)(c(dt),c(mt),c(F))};static \u0275cmp=g({type:e,selectors:[["app-discount-category-list"]],decls:17,vars:3,consts:[[1,"container"],[1,"header"],["mat-raised-button","","color","primary",3,"click"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(n,t){n&1&&(o(0,"div",0)(1,"div",1)(2,"h1"),r(3,"Categor\xEDas de Descuento (Productos)"),a(),o(4,"button",2),u("click",function(){return t.openForm()}),o(5,"mat-icon"),r(6,"add"),a(),r(7," Nueva Categor\xEDa "),a()(),o(8,"table",3),v(9,4),p(10,Dt,2,0,"th",5)(11,Mt,2,1,"td",6),S(),v(12,7),p(13,yt,2,0,"th",5)(14,bt,7,0,"td",6),S(),p(15,ht,1,0,"tr",8)(16,vt,1,0,"tr",9),a()()),n&2&&(l(8),s("dataSource",t.categories),l(7),s("matHeaderRowDef",t.displayedColumns),l(),s("matRowDefColumns",t.displayedColumns))},dependencies:[_,nt,Q,W,tt,X,U,et,Y,Z,it,ot,M,D,k,K,J,y,I],styles:[".container[_ngcontent-%COMP%]{padding:20px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}table[_ngcontent-%COMP%]{width:100%}"]})}return e})();export{Zt as DiscountCategoryListComponent};
