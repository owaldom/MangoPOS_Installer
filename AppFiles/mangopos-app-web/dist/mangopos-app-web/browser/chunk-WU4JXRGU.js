import{c as ye}from"./chunk-YCYMFYGN.js";import{a as T}from"./chunk-V3DAK33I.js";import{a as De}from"./chunk-GZG33B4A.js";import"./chunk-ISB5W5SX.js";import{a as we}from"./chunk-NL74O3Y5.js";import{a as xe,b as Me,c as be}from"./chunk-HIZ742YJ.js";import"./chunk-XEWEKXFC.js";import"./chunk-RFRKPPY3.js";import{c as Ee,h as Te}from"./chunk-Z6YHTX75.js";import{a as A,b as W}from"./chunk-26KDQVR5.js";import{a as ve}from"./chunk-DGQM6DPS.js";import{a as me}from"./chunk-SCPRHZYR.js";import"./chunk-EQXJNMRX.js";import{b as ne,c as oe}from"./chunk-APXOZHQA.js";import{a as pe,b as ce,c as de,d as se,e as ue,f as _e,g as fe,h as Ce,i as Se,j as ge,l as he}from"./chunk-VJGP4MMT.js";import"./chunk-VNZMNOUU.js";import"./chunk-YCMZOG5D.js";import{a as G,b as J,c as K,d as U,f as X,h as Y}from"./chunk-ZWM7H6SC.js";import{a as le}from"./chunk-PALJ6VDH.js";import"./chunk-TEMJ73U5.js";import"./chunk-52A733DE.js";import"./chunk-GPHRSLLH.js";import{b as Z,f as ee,i as te,j as ie}from"./chunk-EWTXOCXT.js";import{b as Q,f as L,j,x as q}from"./chunk-AVLO2MYP.js";import{a as ae,b as re}from"./chunk-JI7GBIO6.js";import"./chunk-VTP6RNFS.js";import{H as $,I as H,K as N}from"./chunk-M7DMR53X.js";import"./chunk-JAVK727W.js";import"./chunk-3TNWXQYU.js";import"./chunk-UWUK32S4.js";import{l as F,s as R,v as z}from"./chunk-ZD4QWOHN.js";import{$ as g,$b as D,Fb as s,Gb as i,Hb as n,Ib as M,Mb as u,Nb as _,Pb as v,Ub as d,Wa as m,Wb as f,_b as y,ac as P,ea as h,fa as x,ic as a,jb as w,jc as k,kc as C,nc as I,oc as O,pb as c,pc as B,vc as b,wc as V,xc as E}from"./chunk-WSMHJDAT.js";import"./chunk-C6Q5SG76.js";function Pe(e,r){if(e&1){let t=v();i(0,"button",8),d("click",function(){h(t);let o=f();return x(o.clearSearch())}),i(1,"mat-icon"),a(2,"close"),n()()}}function ke(e,r){e&1&&(i(0,"th",26),a(1," RIF / CIF "),n())}function Ie(e,r){if(e&1&&(i(0,"td",27),a(1),n()),e&2){let t=r.$implicit;m(),C(" ",t.cif," ")}}function Oe(e,r){e&1&&(i(0,"th",26),a(1," Nombre "),n())}function Be(e,r){if(e&1&&(i(0,"small",30),a(1),n()),e&2){let t=f().$implicit;m(),C("(",t.contactcomm,")")}}function Ve(e,r){if(e&1&&(i(0,"td",27)(1,"div",28)(2,"span"),a(3),n(),c(4,Be,2,1,"small",29),n()()),e&2){let t=r.$implicit;m(3),k(t.name),m(),s("ngIf",t.contactcomm)}}function Fe(e,r){e&1&&(i(0,"th",26),a(1," Tel\xE9fono (Com) "),n())}function Re(e,r){if(e&1&&(i(0,"td",27),a(1),b(2,"phoneFormat"),n()),e&2){let t=r.$implicit;m(),C(" ",V(2,1,t.phonecomm)," ")}}function ze(e,r){e&1&&(i(0,"th",26),a(1," Email "),n())}function $e(e,r){if(e&1&&(i(0,"td",27),a(1),n()),e&2){let t=r.$implicit;m(),C(" ",t.email||"-"," ")}}function He(e,r){e&1&&(i(0,"th",26),a(1," Total Abonado "),n())}function Ne(e,r){if(e&1&&(i(0,"td",31),a(1),b(2,"number"),n()),e&2){let t=r.$implicit,l=f();m(),C(" ",E(2,1,t.total_paid,l.settingsService.getDecimalFormat("total"))," ")}}function Ae(e,r){e&1&&(i(0,"th",26),a(1," Deuda Total "),n())}function We(e,r){if(e&1&&(i(0,"td",32),a(1),b(2,"number"),n()),e&2){let t=r.$implicit,l=f();m(),C(" ",E(2,1,t.balance,l.settingsService.getDecimalFormat("total"))," ")}}function Qe(e,r){e&1&&(i(0,"th",26),a(1," Acciones "),n())}function Le(e,r){if(e&1){let t=v();i(0,"td",27)(1,"button",33),d("click",function(){let o=h(t).$implicit,p=f();return x(p.openViewDialog(o))}),i(2,"mat-icon"),a(3,"visibility"),n()(),i(4,"button",34),d("click",function(){let o=h(t).$implicit,p=f();return x(p.openDialog(o))}),i(5,"mat-icon"),a(6,"edit"),n()(),i(7,"button",35),d("click",function(){let o=h(t).$implicit,p=f();return x(p.delete(o))}),i(8,"mat-icon"),a(9,"delete"),n()()()}}function je(e,r){e&1&&M(0,"tr",36)}function qe(e,r){e&1&&M(0,"tr",37)}function Ge(e,r){e&1&&(i(0,"div",38)(1,"mat-icon"),a(2,"search_off"),n(),i(3,"p"),a(4,"No se encontraron proveedores"),n()())}var Tt=(()=>{class e{supplierService=g(De);settingsService=g(ve);dialog=g(Ee);snackBar=g(A);suppliers=[];displayedColumns=["cif","name","phone","email","total_paid","balance","actions"];searchText="";loading=!1;totalElements=0;pageSize=50;paginator;ngOnInit(){this.loadSuppliers()}loadSuppliers(t=1){this.loading=!0,this.supplierService.getAll(t,this.pageSize,this.searchText).subscribe({next:l=>{this.suppliers=l.data,this.totalElements=l.total,this.loading=!1},error:l=>{console.error("Error loading suppliers",l),this.loading=!1,this.snackBar.open("Error al cargar proveedores","Cerrar",{duration:3e3})}})}onPageChange(t){this.loadSuppliers(t.pageIndex+1)}search(){this.loadSuppliers()}clearSearch(){this.searchText="",this.loadSuppliers()}openDialog(t){this.dialog.open(T,{width:"900px",maxWidth:"95vw",data:t||null}).afterClosed().subscribe(o=>{o&&(this.loadSuppliers(),this.snackBar.open(t?"Proveedor actualizado":"Proveedor creado","Cerrar",{duration:3e3}))})}openViewDialog(t){this.dialog.open(T,{width:"900px",maxWidth:"95vw",data:{supplier:t,viewOnly:!0}})}delete(t){confirm(`\xBFEst\xE1 seguro de eliminar al proveedor "${t.name}"?`)&&this.supplierService.delete(t.id).subscribe({next:()=>{this.loadSuppliers(),this.snackBar.open("Proveedor eliminado","Cerrar",{duration:3e3})},error:l=>{console.error("Error removing supplier",l),this.snackBar.open("Error al eliminar proveedor","Cerrar",{duration:3e3})}})}static \u0275fac=function(l){return new(l||e)};static \u0275cmp=w({type:e,selectors:[["app-suppliers"]],viewQuery:function(l,o){if(l&1&&y(xe,5),l&2){let p;D(p=P())&&(o.paginator=p.first)}},decls:49,vars:8,consts:[[1,"container"],[1,"main-card"],[1,"spacer"],["mat-raised-button","","color","primary",3,"click"],[1,"search-bar"],["appearance","outline"],["matInput","","placeholder","Nombre, RIF...",3,"ngModelChange","keyup.enter","ngModel"],["mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],["mat-icon-button","","matSuffix","",3,"click"],[1,"table-container"],["mat-table","",1,"mat-elevation-z0",3,"dataSource"],["matColumnDef","cif"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","phone"],["matColumnDef","email"],["matColumnDef","total_paid"],["mat-cell","","class","paid-cell",4,"matCellDef"],["matColumnDef","balance"],["mat-cell","","class","debt-cell",4,"matCellDef"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"page","length","pageSize"],["class","empty-state",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],[1,"name-col"],["class","contact-name",4,"ngIf"],[1,"contact-name"],["mat-cell","",1,"paid-cell"],["mat-cell","",1,"debt-cell"],["mat-icon-button","","color","accent","matTooltip","Ver Detalle",3,"click"],["mat-icon-button","","color","primary","matTooltip","Editar",3,"click"],["mat-icon-button","","color","warn","matTooltip","Eliminar",3,"click"],["mat-header-row",""],["mat-row",""],[1,"empty-state"]],template:function(l,o){l&1&&(i(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title"),a(4,"Gesti\xF3n de Proveedores"),n(),i(5,"mat-card-subtitle"),a(6,"Administre el registro y detalle de proveedores"),n(),M(7,"span",2),i(8,"button",3),d("click",function(){return o.openDialog()}),i(9,"mat-icon"),a(10,"add"),n(),a(11," Nuevo Proveedor "),n()(),i(12,"mat-card-content")(13,"div",4)(14,"mat-form-field",5)(15,"mat-label"),a(16,"Buscar"),n(),i(17,"input",6),B("ngModelChange",function(S){return O(o.searchText,S)||(o.searchText=S),S}),d("keyup.enter",function(){return o.search()}),n(),c(18,Pe,3,0,"button",7),i(19,"button",8),d("click",function(){return o.search()}),i(20,"mat-icon"),a(21,"search"),n()()()(),i(22,"div",9)(23,"table",10),u(24,11),c(25,ke,2,0,"th",12)(26,Ie,2,1,"td",13),_(),u(27,14),c(28,Oe,2,0,"th",12)(29,Ve,5,2,"td",13),_(),u(30,15),c(31,Fe,2,0,"th",12)(32,Re,3,3,"td",13),_(),u(33,16),c(34,ze,2,0,"th",12)(35,$e,2,1,"td",13),_(),u(36,17),c(37,He,2,0,"th",12)(38,Ne,3,4,"td",18),_(),u(39,19),c(40,Ae,2,0,"th",12)(41,We,3,4,"td",20),_(),u(42,21),c(43,Qe,2,0,"th",12)(44,Le,10,0,"td",13),_(),c(45,je,1,0,"tr",22)(46,qe,1,0,"tr",23),n(),i(47,"app-shared-paginator",24),d("page",function(S){return o.onPageChange(S)}),n(),c(48,Ge,5,0,"div",25),n()()()()),l&2&&(m(17),I("ngModel",o.searchText),m(),s("ngIf",o.searchText),m(5),s("dataSource",o.suppliers),m(22),s("matHeaderRowDef",o.displayedColumns),m(),s("matRowDefColumns",o.displayedColumns),m(),s("length",o.totalElements)("pageSize",o.pageSize),m(),s("ngIf",o.suppliers.length===0&&!o.loading))},dependencies:[z,F,q,Q,L,j,Y,G,K,X,U,J,he,pe,de,fe,se,ce,Ce,ue,_e,Se,ge,N,H,$,re,ae,oe,ne,te,Z,ee,ie,Te,W,Me,be,ye,me,le,R,we],styles:[".container[_ngcontent-%COMP%]{padding:20px}.main-card[_ngcontent-%COMP%]{min-height:500px}mat-card-header[_ngcontent-%COMP%]{margin-bottom:20px;display:flex;align-items:center}.spacer[_ngcontent-%COMP%]{flex:1 1 auto}.search-bar[_ngcontent-%COMP%]{margin-bottom:20px}.search-bar[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.table-container[_ngcontent-%COMP%]{overflow-x:auto}table[_ngcontent-%COMP%]{width:100%}.name-col[_ngcontent-%COMP%]{display:flex;flex-direction:column}.contact-name[_ngcontent-%COMP%]{color:#757575;font-size:.85em}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:40px;color:#757575}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;height:48px;width:48px;margin-bottom:10px}.debt-cell[_ngcontent-%COMP%]{color:#d32f2f;font-weight:700;text-align:right}.paid-cell[_ngcontent-%COMP%]{color:#2e7d32;font-weight:700;text-align:right}"]})}return e})();export{Tt as SuppliersComponent};
